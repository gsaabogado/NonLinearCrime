[
  {
    "objectID": "02_exhibits.html",
    "href": "02_exhibits.html",
    "title": "Study Exhibits",
    "section": "",
    "text": "In this section, I present all the exhibits in the study: The nonlinear effects of pollution on crime: Evidence from Mexico City and New York – Forthcoming in Environmental Research - Health\nI structure the section in four different subsections:\n\nTheoretical Background\nData\nResults\nRobustness\nAppendix\n\nThese subsections are in line with the study’s structure. For each subsection, there is a panel-tabset of figures and tables part of the corresponding section in the printer article. Each tab contains the table and figure number that corresponds to the original study.\n\nTheoretical Background\nIn the theoretical section of the study, I present a slight theoretical introduction to the relationship between air pollution and crime while building support for the hypothesis that air pollution has a non-linear effect on criminality. This section consist of four figures\n\nFigure 1: Probability mass function for different Poisson distributions. The figure presents the probability mass function of this study’s primary data set on the number of hourly crimes occurring in the vicinity of pollution measuring stations in Mexico City and New York alongside four simulated Poisson distributions with variances equal to 0.25, 0.5, 0.75, and 1.0\nFigure 2 (a): Relationship of the matching function with the number of victims and criminals. The figure shows the proposed theoretical relation between the match of victims and criminals in the market and the number of agents.\nFigure 2 (b): Relationship between exposure to air pollution and the number of victims and criminals. The figure shows the theoretical relationship between the number of agents in the market and air pollution.\nFigure 3: Theoretical relationship between air pollution and crime; the red line marks the level of air pollution that maximizes criminality, i.e., \\(\\frac{\\partial crime}{\\partial pollution} = 0\\).\n\n\nFigure 1Figure 2(a)Figure 2(b)Figure 3\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Compute the different Poisson distributions\nplot = list(`0.25` = data.frame(value = stats::rpois(3000000, 0.25 )) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)),\n            \n            `0.5` = data.frame(value = stats::rpois(3000000, 0.5 )) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n            `0.75` = data.frame(value = stats::rpois(3000000, 0.75)) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n            `1.0` = data.frame(value = stats::rpois(3000000, 1)) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n             `Real Sample` = data %>% group_by(value = total) %>% summarise(count = n())%>% \n              mutate(count = count/sum(count))) %>% rbindlist(., idcol = \"Lambda\")\n# Plot the empirical data and the different poisson distributions\nggplot(dplyr::filter(plot, value < 10)) + \n  geom_line(aes(x = value, y = count, color = Lambda)) +\n  geom_point(aes(x = value, y = count, color = Lambda)) +\n  theme(panel.background = element_rect(fill = \"transparent\"),\n        strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0),  legend.title = element_blank(), \n        legend.box.background = element_rect(fill = \"transparent\"),\n        legend.background = element_blank(), legend.key = element_rect(fill = \"transparent\"),\n        axis.line = element_line(), legend.position = c(0.85, 0.7))  +\n  ggpubr::grids() + labs(x = \"k\", y = \"P(Crimes = k)\") +\n  scale_x_continuous(breaks= scales::pretty_breaks()) +\n  scale_color_manual(values = c(\"gray20\", \"gray40\", \"gray60\", \"gray80\", \"orange\"))\n\n\n\n\n\nFigure 1: Probability mass function for different Poisson distributions\n\n\n\n\nNotes: This figure presents the probability mass function of this study’s primary data set on the number of hourly crimes occurring in the vicinity of pollution measuring stations in Mexico City and New York alongside four simulated Poisson distributions with variances equal to 0.25, 0.5, 0.75, and 1.0\n\n\n\n\nShow the Code\n# Construct the dummy data\ndata = data.frame(temp = seq(0,40,2), s = seq(0, 1, 0.05), p = seq(1, 0, -0.05)) |> \n  mutate(s_1 = s*p) |>  mutate(s_1 = ((s_1 - min(s_1))/(max(s_1)- min(s_1)))) |> \n  filter(temp <= 20)\n# Plot the function\nggplot() + geom_line(data = data, aes(x = temp, y = s_1)) + \n  geom_point(data = data, aes(x = temp, y = s_1)) + \n  theme(panel.background = element_blank(), axis.line = element_line(), axis.text = element_blank()) + ggpubr::grids() +\n  labs(x = \"V(t), C(t)\", y= \"m[V(t), C(t)]\") \n\n\n\n\n\nFigure 2: Relationship of the matching function with the number of victims and criminals\n\n\n\n\n\n\n\n\nShow the Code\n# Construct the simulated data\ndata = data.frame(temp = seq(0,40,2), s = seq(0, 1, 0.05), p = seq(1, 0, -0.05)) |> \n  mutate(s_1 = s*p*-1) |>  mutate(s_1 = ((s_1 - min(s_1))/(max(s_1)- min(s_1)))) |> \n  filter(temp <= 20)\n# Plot the function\nggplot() + geom_line(data = data, aes(x = temp, y = s_1)) + \n  geom_point(data = data, aes(x = temp, y = s_1)) + \n  theme(panel.background = element_blank(), axis.line = element_line(), axis.text = element_blank()) + ggpubr::grids() +\n  labs(y = \"V(t), C(t)\", x= \"Exposure to air Pollution\") \n\n\n\n\n\nFigure 3: Relationship between exposure to air pollution and the number of victims and criminals\n\n\n\n\n\n\n\n\n\nFigure 4: Theoretical relationship between air pollution and crime; the red line marks the level of air pollution that maximizes criminality, i.e., \\(\\frac{\\partial crime}{\\partial pollution} = 0\\).\n\n\n\n\n\n\n\nDescriptive Statistics (Data section)\nThis section corresponds to the Data section of the study. It contains a set of descriptive statistics and data documentation through two figures and one table.\n\nFigure 4: The grid shows the temporal behavior of criminality in Mexico City and New York. Clockwise it shows the hourly, monthly, and yearly variation concerning the average.\nFigure 5: Location of pollution measuring stations in Mexico City and New York.\nTable 1: Descriptive statistics on the number of hourly crimes happening in a two-kilometer radius around pollution measuring stations in Mexico City and New York.\n\n\nFigure 4Figure 5Table 1\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Aggregate to the hourly level\nhr = data %>% group_by(value = as.numeric(hour), city) %>% summarise(count = sum(total)) %>% \n  group_by(city) %>%  mutate(avg = mean(count, na.rm = T))%>%\n  mutate(dev = ((count-avg)/avg)*100) %>% mutate(variable = \"Hourly Variation\")\n# Aggregate to the monthly leve\nmo = data %>% group_by(value = as.numeric(month), city) %>% \n  summarise(count = sum(total))  %>% group_by(city) %>% mutate(avg = mean(count, na.rm = TRUE)) %>%\n  mutate(dev = ((count-avg)/avg)*100) %>% mutate(variable = \"Monthly Variation\")\n# Aggregate to the yearly leve\nye = data %>% group_by(value = as.numeric(year), city) %>% summarise(count = sum(total))  %>% \n  group_by(city) %>% mutate(avg = mean(count, na.rm = TRUE)) %>%\n  mutate(dev = ((count-avg)/avg)*100)%>% mutate(variable = \"Yearly Variation\") %>%\n  filter(value != 2006)\n# Rbindlist all data sets\ntemporal = rbindlist(list(hr, mo, ye)) %>% mutate(value = as.numeric(value))\n# Change the name of the city\ntemporal = mutate(temporal, city = ifelse(city == \"nyc\", \"New York City\", \"Mexico City\"))\n# Plot the deviation from the average\nggplot(temporal) + geom_line(aes(x = value, y = dev, color = city, group = city)) +\n  geom_point(aes(x = value, y = dev, color = city, group = city)) +\n  facet_wrap(~variable, scales = \"free\") +\n  theme(panel.background = element_rect(fill = \"transparent\"),strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0), axis.line = element_line(), legend.position = \"bottom\", \n        legend.title = element_blank(),)  +\n  ggpubr::grids() + labs(x = \"\", y = \"% Deviation from the mean\")  +\n  scale_color_manual(values = c(\"black\", \"darkorange\")) +\n  scale_x_continuous(breaks= scales::pretty_breaks())\n\n\n\n\n\nFigure 5: The grid shows the temporal behavior of criminality in Mexico City and New York. Clockwise it shows the hourly, monthly, and yearly variation concerning the average.\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n#### Load the spatial data\nnyc = read_sf(paste0(file, \"01_RawData/03_shapefiles/NYC Buroughs\")) %>% \n  mutate(city = \"New York\") %>% select(city) \n\ncdmx = read_sf(paste0(file, \"01_RawData/03_shapefiles/States in Mexico\")) %>% \n  filter(ENTIDAD == \"DISTRITO FEDERAL\") %>% \n  mutate(city = \"Mexico City\") %>% select(city) %>% st_cast(., \"MULTIPOLYGON\")\n# Exclude stations with no crimes during the entire period\ndata = data %>% group_by(station) %>% filter(sum(total) != 0)\nPolSt = select(data, station, lon, lat) |> distinct()\n# Create a data set of stations for Mexico City\nstcdmx = select(data, station, lon, lat, city) %>% distinct()%>% filter(city == \"cdmx\") %>% \n  st_as_sf(., coords = c(\"lon\", \"lat\"), crs = st_crs(nyc)) \n# create a data set of stations\nstnyc = select(data, station, lon, lat, city) %>% distinct()%>% filter(city == \"nyc\") %>% \n  st_as_sf(., coords = c(\"lon\", \"lat\"), crs = st_crs(nyc)) \n# Transform the stations into a spatial set\nPolSt =  st_as_sf(PolSt, coords = c(\"lon\", \"lat\"), crs = 4326)\n# Aggregate the shapefiles of ploygons and stations in both cities\nshp = rbind(st_transform(nyc, crs = 4326), st_transform(cdmx, crs = 4326))\nst = rbind(stcdmx, stnyc)\n# Map the stations over Spain and Madrid\ntmap_style(\"classic\")\n\ntmap = tm_graticules(labels.cardinal = F, alpha = 0.5, , labels.size = 0.75) + \n  tm_shape(shp) + tm_polygons(col = \"black\") +\n  tm_facets(by = \"city\") + tm_shape(st) +\n  tm_dots(size = 0.1, col = \"white\") + tmap_options(check.and.fix = TRUE) +\n  tm_compass(type = \"rose\", position = c(\"left\", \"top\"), size = 3) +\n  tm_scale_bar(width = 0.20, position = c(\"left\", \"bottom\"), text.size = 0.75) +\n  tm_layout(legend.outside = F, legend.stack = \"horizontal\",\n            legend.position = c(\"left\", \"top\"), \n            inner.margins = c(0.05, 0.05, 0.05, 0.05)); tmap\n\n\n\n\n\nFigure 6: Location of pollution measuring stations in Mexico City and New York\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Select only the crime data\ndata = select(data, city, station, date, hour, \n              a = total, b = Violent, c = NonViolent) %>%\n  gather(., crime, value, c(a, b, c))\n# Compute the shares of zeros \nzeros = ungroup(data) %>% \n  group_by(city, crime) %>%\n  summarise(`Zeros N` = sum(value == 0), NoZeros = sum(value > 0)) %>% \n  mutate(`Zeros %` = `Zeros N`/(`Zeros N` + NoZeros)) %>% \n  mutate(`Zeros %` = round(`Zeros %`, 2)) %>% select(-NoZeros) %>%\n  arrange(city, crime)\n# Spread the data set\ndata = spread(data, crime, value)\n# Create the data frame of summary stats\ntab = st(ungroup(data) |> dplyr::filter(city == \"cdmx\") |> select(a, b, c), \n   summ = c(\"mean(x)\", \"var(x)\", \"min(x)\", \"max(x)\", \"notNA(x)\"), \n   summ.names = c(\"Mean\", \"Variance\", \"Min\", \"Max\", \"N\"), \n   labels = c(\"Total\", \"Violent\", \"Non Violent\"), \n   digits = 2, fixed.digits = T, out = \"return\") %>%\n  \n  rbind(.,  st(ungroup(data) |> dplyr::filter(city == \"nyc\") |> select(a, b, c), \n   summ = c(\"mean(x)\", \"var(x)\", \"min(x)\", \"max(x)\", \"notNA(x)\"), \n   summ.names = c(\"Mean\", \"Variance\", \"Min\", \"Max\", \"N\"), \n   labels = c(\"Total\", \"Violent\", \"Non Violent\"), \n   digits = 2, fixed.digits = T, out = \"return\"))\n# Add the year of observations\ntab = mutate(tab, `Obs Period` = c(rep(\"2012-2019\", 3), rep(\"2007-2017\", 3)))\n# add the zeros\ntab = cbind(tab, `Zeros N` = zeros$`Zeros N`); tab = cbind(tab, `Zeros %` =zeros$`Zeros %`)\ntab = select(tab, Variable, `Obs Period`, Mean:N, `Zeros N`, `Zeros %`)\n# Create the Kable object \nkbl(tab) %>%\nkable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>% \n   pack_rows(\"Mexico City\", 1, 3) %>% pack_rows(\"Mexico City\", 4, 6)\n\n\n\n\nTable 1:  Descriptive statistics on the number of hourly crimes happening in a two-kilometer radius around pollution measuring stations in Mexico City and New York. \n \n  \n    Variable \n    Obs Period \n    Mean \n    Variance \n    Min \n    Max \n    N \n    Zeros N \n    Zeros % \n  \n \n\n  Mexico City\n\n    Total \n    2012-2019 \n    0.30 \n    0.53 \n    0 \n    46 \n    1433832 \n    1125888 \n    0.79 \n  \n  \n    Violent \n    2012-2019 \n    0.10 \n    0.12 \n    0 \n    7 \n    1433832 \n    1301749 \n    0.91 \n  \n  \n    Non Violent \n    2012-2019 \n    0.10 \n    0.15 \n    0 \n    21 \n    1433832 \n    1316376 \n    0.92 \n  \n  Mexico City\n\n    Total \n    2007-2017 \n    0.93 \n    1.75 \n    0 \n    55 \n    1510319 \n    785423 \n    0.52 \n  \n  \n    Violent \n    2007-2017 \n    0.16 \n    0.22 \n    0 \n    11 \n    1510319 \n    1311999 \n    0.87 \n  \n  \n    Non Violent \n    2007-2017 \n    0.32 \n    0.46 \n    0 \n    22 \n    1510319 \n    1154301 \n    0.76 \n  \n\n\n\n\n\n\n\n\n\n\n\nResults section\nTable 2 contains the coefficients on the linear effect of the Now Cast AQI on crime counts in New York and Mexico City. Table 3 contains the coefficients of the quadratic model estimating the relationship between pollution and criminality. Figure 7 shows the out-of-sample prediction of the quadratic model coefficients. Figure 8 portrays the marginal effect of each additional AQI unit on criminality. Figure 9 adds the point estimates of the Nonparametric model. Table 4 contains the coefficients of the linear and quadratic models on the relationship between pollution and criminality for violent and nonviolent crimes. Table 5 contains the estimates on the effects across all crime categories.\n\nTable 2Table 3Figure 6Figure 7Figure 8Table 5\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"/02_GenData/04_results/PoissonLinear.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Estimate\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\", general_title = \"Notes:\", footnote_as_chunk = T)\n\n\n\n\nTable 2:  Effect of pollution on criminality (linear model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Estimate \n    0.197 * \n    0.272 ** \n    0.327 ** \n    0.363 *** \n    0.420 *** \n    0.477 *** \n  \n  \n     \n    (0.111) \n    (0.117) \n    (0.131) \n    (0.109) \n    (0.102) \n    (0.102) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618359 \n    1638412 \n    2844555 \n    2844488 \n    2862656 \n  \n\n\nNotes:  $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadratic.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Linear\", \" \", \"Quadratic\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 5, 7) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T)\n\n\n\n\nTable 3:  Effect of pollution on criminality (quadratic model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Linear \n    0.779 *** \n    1.012 *** \n    1.238 *** \n    0.819 *** \n    0.914 *** \n    1.090 *** \n  \n  \n     \n    (0.252) \n    (0.240) \n    (0.251) \n    (0.292) \n    (0.276) \n    (0.264) \n  \n  \n    Quadratic \n    -0.003 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 * \n    -0.004 ** \n    -0.005 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618352 \n    1638394 \n    2844558 \n    2844490 \n    2862651 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\nsum = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadratic.rds\")) %>% \n  filter(var == \"NowCast\" & specification == \"3\")\n# Set the range for the out-of-sample prediction\nplot = data.frame(city = c(\"cdmx\", \"nyc\")) %>% split(., f = .$city) %>%\n  lapply(., function(x) data.frame(city = x$city, aqi = seq(0, 200, 1)))\n# Include the linear estimate and SE\nplot = lapply(plot, function(x) \n  left_join(x, select(filter(sum, estimate == \"Linear\"), city, LinearEst = est, LinearSe = se)) %>%\n  left_join(select(filter(sum, estimate == \"Quadratic\"), city, QuadraticEst = est, QuadraticSe = se)))\n# Determine the out-of-sample effect\nplot = lapply(plot, function(x) \n  mutate(x, LinearValue = aqi*LinearEst) %>% \n    mutate(QuadraticValue = aqi^2*QuadraticEst))\n# Determine the effect and bliss point\nplot = lapply(plot, function(x) \n  mutate(x, value = LinearValue + QuadraticValue) %>% \n    mutate(bliss = max(filter(x, value > dplyr::lag(value, 1))$aqi))) %>%\n  rbindlist(.)\n# Transform to number of additional crimes\nplot = plot %>% mutate_at(vars(value), function(x) x = (exp(x) -1)*100)\n# Change the name of the cities\nplot = mutate(plot, city  = mgsub(city, c(\"nyc\", \"cdmx\"), c(\"New York City\", \"Mexico City\")))\n# Make the plot\nggplot(plot) +\n  geom_rect(data = plot %>% group_by(city) %>% filter(value == max(value)), \n            aes(ymin = 0, ymax = value, xmin = 0, xmax = 50), alpha = 0.2, fill = \"green\")  +\n  geom_rect(data = plot %>% group_by(city) %>% filter(value == max(value)), \n            aes(ymin = 0, ymax = value, xmin = 51, xmax = 100), alpha = 0.2, fill = \"yellow\")  +\n  geom_rect(data = plot %>% group_by(city) %>% filter(value == max(value)), \n            aes(ymin = 0, ymax = value, xmin = 101, xmax = 150), alpha = 0.2, fill = \"orange\")  +\n  geom_rect(data = plot %>% group_by(city) %>% filter(value == max(value)), \n            aes(ymin = 0, ymax = value, xmin = 151, xmax = 200), alpha = 0.2, fill = \"brown\")  +\n  geom_line(aes(x = aqi, y = value, group = 1)) +\n  theme(panel.background = element_rect(fill = \"white\", color = \"white\"), \n        strip.background = element_rect(fill = \"white\", color = \"white\"),text = element_text(size = 10), \n        axis.line = element_line(), strip.text = element_text(hjust = 0), \n        legend.position = \"bottom\", legend.title = element_blank() , panel.spacing = unit(2, \"lines\"),) +\n  grids(color = \"gray90\") + labs(y = \"Crimes\", x = \"AQI\") + \n  facet_wrap(~city, scales = \"free\") + grids() +\n  geom_point(data = filter(plot, aqi == bliss), aes(x = aqi, y = value)) +\n  geom_rect(data = filter(plot, aqi == bliss), aes(ymin = 0, ymax = value, xmin = aqi, xmax = aqi), \n            color = \"black\", linetype = \"dotted\", alpha = 0.5) +\n  geom_text(data = filter(plot, aqi == bliss), \n            aes(aqi, value, label = (paste(expression(paste(frac(paste(partialdiff,\"Crimes\"),\n                                                           paste(partialdiff,\"Pol\")), \" = 0\"))))), \n            parse = T, hjust = 2, vjust = 1.1, size = 3.5, angle = 90)                                      \n\n\n\n\n\nFigure 7: Nonlinear effect of air pollution on criminality\n\n\n\n\nNotes: This figure shows the value of the Now Cast AQI on the horizontal axis and the effect of multiplying linear and quadratic coefficients by this concentration level on the vertical axis. Each color block refers to the risk levels of exposure proposed by the EPA (see figure z). The vertical line indicates the point where the impact of exposure stops increasing and starts decreasing criminality. Linear and quadratic coefficients come from a PMLE panel model controlling for weather, year-by-month-by-station, hour, and weekday fixed effects – standard errors clustered at the station level.\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\nnyc = read_rds(paste0(file, \"/02_GenData/04_results/NycMarginal.rds\"))\ncdmx = read_rds(paste0(file, \"/02_GenData/04_results/CdmxMarginal.rds\"))\n# Add both data sets together\ndata = rbindlist(list(`New York City` = nyc, `Mexico City` = cdmx), idcol = \"city\")\n# Take the exponent of the point estimates\ndata = data %>% mutate_at(vars(dydx, BtrSe), function(x) x = (exp(x) -1)*100)\n# Determine the value in which the marginal effect crosses the horizontal axis\ndata = split(data, f = data$city) %>% lapply(., function(x) x = x |> \n  mutate(effect = ifelse(abs(dydx) == min(abs(as.numeric(dydx)), na.rm = T), as.numeric(NowCast), NA))|> \n  mutate(effect = mean(as.numeric(effect), na.r = T))) %>% rbindlist(.)\n# Review the moment in which the point estimates are no longer significant\ndata = data |> mutate(positive = abs(dydx + BtrSe*1.645), negative = abs(dydx  - BtrSe*1.645))\n#### Plot the effect #####\nggplot(data) + \n  geom_line(aes(x = NowCast, y = dydx)) +\n  geom_line(aes(x = NowCast, y = dydx + BtrSe*1.645), col = \"orange\") +\n  geom_line(aes(x = NowCast, y = dydx - BtrSe*1.645), col = \"orange\") +\n  geom_vline(aes(xintercept = effect), linetype = \"dashed\") +\n  theme(panel.background = element_blank(), axis.line = element_line(), \n        strip.background = element_blank(), strip.text = element_text(hjust = 0)) + \n  ggpubr::grids() + facet_wrap(~city, scales = \"free\") +\n  labs(y = expression(paste(partialdiff,\"Crime\",\"/\",partialdiff,\"Air Pol. (90% CI)\")), x = \"Now Cast Aqi\")                                   \n\n\n\n\n\nFigure 8: Estimated marginal effects of air pollution on crime\n\n\n\n\nNotes: This figure shows the value of the NowCast aqi on the horizontal axis and the partial derivative of criminality concerning the NowCast aqi on the vertical axis. The vertical line indicates the point where the impact of exposure stops increasing and starts decreasing criminality. Point estimates come from the PMLE panel model controlling for weather, year-by-month-by-station, hour, and weekday fixed effects. I compute the marginal effects with the R-marginal effects package. – standard errors estimated through one thousand bootstraps.\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data sets\ndata = read_rds(paste0(file, \"02_GenData/04_results/PoissonNonParametric.rds\"))\n# Take the exponent of the point estimates\ndata = data %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100)\n#### Change the name of pollutants ####\ndata = mutate(data, var  = gsub(\"NowCast\", \"AQI\", var))\ndata = mutate(data, city  = mgsub(city, c(\"nyc\", \"cdmx\"), c(\"New York City\", \"Mexico City\")))\n#### Organize the cities as factors ####\ndata = mutate(data, city = factor(city, levels = c(\"Mexico City\", \"New York City\")))\n#### Plot the point estimates for the prefered specification ####\nggplot(filter(data, grepl(\"AQI\", var), specification == \"3\")) +\n  stat_smooth(aes(x = min, y = est), method=\"lm\", se=FALSE, \n              fill = NA, formula=y ~ poly(x, 2, raw=TRUE), colour=\"darkgrey\", lwd = 0.5) + \n  geom_point(aes(x = min, y = est)) +\n  geom_errorbar(aes(ymin = est-se*1.645, ymax = est+se*1.645, x = min), width = 8) +\n  facet_wrap(~city, scales = \"free\") +\n  theme(panel.background = element_rect(fill = \"transparent\"),\n        strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0), axis.line = element_line(), \n        legend.position = \"bottom\", panel.spacing = unit(2, \"lines\"),\n        legend.title = element_blank(), axis.text.x = element_blank(), \n        axis.ticks.x = element_blank())  +\n  grids() + geom_hline(aes(yintercept = 0), color = \"orange\") +\n  geom_text(aes(x = min, y = est+se*1.645, label = bin), size = 2.5, vjust = -0.5) +\n  labs(x = \"Exposure bin\", y = \"Estimate\") +\n  annotate(\"segment\", x=-Inf, xend=Inf, y=-Inf, yend=-Inf) +\n  annotate(\"segment\", x=-Inf, xend=-Inf, y=-Inf, yend=Inf, color = \"black\", lwd = 1)\n\n\n\n\n\nFigure 9: Non-parametric estimates of the effect of pollution on criminality\n\n\n\n\nNotes: This figure shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the effect of one hour in the indicated bin concerning the lowest bin value. Point estimates come from a non-parametric PMLE panel model of crime as a function of six bin indicators. This model contains weather controls alongside year-by-month-by-station, hour, and weekday fixed effects. The grey line is a second-degree polynomial fit across point estimates – standard errors clustered at the station level.  ## Table 4\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticViolent.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Change the names of the types of crime ####\ntab = mutate(tab, dependent = mgsub(dependent, c(\"NonViolent\"), c(\"Non Violent\")))\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\nviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(violent) = c(\"names\", \"\", \" \", \"N.obs\", \"R2\", \"BIC\") \nviolent = select(violent, -V1); colnames(violent) = violent[1,]; violent = violent[-1, ]\n# Create the data-frame for the html table\nnonviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Non Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(nonviolent) = c(\"names\", \"  \", \"   \", \"N.obs \", \"R2 \", \"BIC \") \nnonviolent = select(nonviolent, -V1); colnames(nonviolent) = nonviolent[1,]; nonviolent = nonviolent[-1, ]\n#\nhtml = rbind(violent ,nonviolent)\n# change the column names \ncolnames(html) = paste0(\"(\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2), \")\")\n# Create the HTML table of the first figure\nkbl(html, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n   pack_rows(\"Violent\", 1, 5) %>%\n  pack_rows(\"Non Violent\", 6, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 4:  Estimates on the effects of air pollution for violent and non-violent crimes \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n    (Linear) \n    (Linear) \n    (Quadratic) \n    (Linear) \n    (Linear) \n    (Quadratic) \n  \n \n\n  Violent\n\n     \n    0.240 * \n    1.556 *** \n    -0.006 *** \n    0.797 *** \n    1.314 ** \n    -0.004 \n  \n  \n     \n    (0.130) \n    (0.304) \n    (0.001) \n    (0.168) \n    (0.517) \n    (0.004) \n  \n  \n    N.obs \n    0.130 \n    0.130 \n    0.130 \n    0.125 \n    0.125 \n    0.125 \n  \n  \n    R2 \n    1322488 \n    1322488 \n    1322488 \n    1244562 \n    1244562 \n    1244562 \n  \n  \n    BIC \n    870538 \n    870529 \n    870529 \n    1085029 \n    1085040 \n    1085040 \n  \n  Non Violent\n\n     \n    0.197 \n    0.704 * \n    -0.002 * \n    0.317 *** \n    0.546 * \n    -0.002 \n  \n  \n     \n    (0.172) \n    (0.407) \n    (0.001) \n    (0.097) \n    (0.291) \n    (0.002) \n  \n  \n    N.obs \n    0.219 \n    0.219 \n    0.219 \n    0.189 \n    0.189 \n    0.189 \n  \n  \n    R2 \n    1300287 \n    1300287 \n    1300287 \n    1271109 \n    1271109 \n    1271109 \n  \n  \n    BIC \n    777428 \n    777439 \n    777439 \n    1597431 \n    1597444 \n    1597444 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticOtherCrimes.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2))\ntab = tab[-1,]\ntab = tab[-c(16,17,18),]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 2, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 5:  Estimates on the effects of air pollution across different crime categories \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n     \n    Linear \n    Linear \n    Quadratic \n    Linear \n    Linear \n    Quadratic \n  \n \n\n  \n    2 \n    Burglary \n    0.340 \n    0.214 \n    0.001 \n    0.169 \n    -0.256 \n    0.004 \n  \n  \n    3 \n     \n    (0.304) \n    (0.871) \n    (0.004) \n    (0.186) \n    (0.571) \n    (0.004) \n  \n  \n    4 \n    Homicide \n    0.521 \n    4.562 ** \n    -0.019 *** \n    0.084 \n    -9.775 \n    0.089 \n  \n  \n    5 \n     \n    (0.850) \n    (1.824) \n    (0.007) \n    (12.396) \n    (25.925) \n    (0.132) \n  \n  \n    6 \n    Robbery \n    0.238 * \n    1.437 *** \n    -0.005 *** \n    0.395 \n    1.614 * \n    -0.010 \n  \n  \n    7 \n     \n    (0.137) \n    (0.346) \n    (0.002) \n    (0.281) \n    (0.887) \n    (0.007) \n  \n  \n    8 \n    Larceny \n    -0.018 \n    0.256 \n    -0.001 \n    0.293 ** \n    0.529 * \n    -0.002 \n  \n  \n    9 \n     \n    (0.124) \n    (0.492) \n    (0.002) \n    (0.126) \n    (0.319) \n    (0.002) \n  \n  \n    10 \n    SexCrime \n    0.497 \n    3.099 ** \n    -0.012 * \n    0.411 *** \n    0.866 *** \n    -0.004 * \n  \n  \n    11 \n     \n    (0.374) \n    (1.534) \n    (0.006) \n    (0.148) \n    (0.299) \n    (0.002) \n  \n  \n    12 \n    fraud \n    0.336 \n    1.580 * \n    -0.005 * \n    0.339 \n    0.586 \n    -0.002 \n  \n  \n    13 \n     \n    (0.243) \n    (0.917) \n    (0.003) \n    (0.318) \n    (1.173) \n    (0.009) \n  \n  \n    14 \n    other \n    0.633 *** \n    1.289 *** \n    -0.003 ** \n    0.402 ** \n    1.287 ** \n    -0.007 ** \n  \n  \n    15 \n     \n    (0.128) \n    (0.368) \n    (0.001) \n    (0.183) \n    (0.521) \n    (0.004) \n  \n  \n    16 \n    R.Squared \n    0.147 \n    0.147 \n    0.147 \n    0.167 \n    0.167 \n    0.167 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\n\nRobustness section\nTable 6 contains the main results of the IV strategy. Table 7 looks at point estimates across different estimators, Table 8 across different specifications, and Table 9 estimates the dynamic effect with distributed lag nonlinear models.\n\nTable 6Table 7Table 8Table 9\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(read_rds(paste0(file, \"/02_GenData/04_results/99_iv/LinearWdr8.rds\")),\n          read_rds(paste0(file, \"/02_GenData/04_results/99_iv/QuadWdr8.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\") %>%\n  mutate(var = ifelse(grepl(\"2\", var), \"Quadratic\", \"Linear\"))\n#### Take the exponent of the point estimates ####\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Split the data set by the distinct specifications ####\ntab = mutate(tab, city = paste(model, city, var))\ntab = split(tab, f = tab$city)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = y),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\",\"Linear\", \"Linear \", \"Linear  \", \"Quadratic\", \" Linear\", \"Quadratic \")\nrownames(tab) = c(\"   \",\"\", \" \", \"R.Squared\", \"N.Obs\", \"BIC\"); tab = tab[-1,-1]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 1, \"New York\" = 1, \"Mexico City\" = 2, \"New York\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 2, \"Quadratic Model\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 6:  Effects of air pollution on criminality (IV) \n \n\n\nLinear Model\nQuadratic Model\n\n\n\nMexico City\nNew York\nMexico City\nNew York\n\n  \n      \n    Linear \n    Linear  \n    Linear   \n    Quadratic \n     Linear \n    Quadratic  \n  \n \n\n  \n     \n    0.327 \n    1.038 *** \n    2.139 *** \n    -0.006 ** \n    1.542 ** \n    -0.004 \n  \n  \n     \n    (0.309) \n    (0.186) \n    (0.584) \n    (0.002) \n    (0.612) \n    (0.006) \n  \n  Fitted-Statistics\n\n    R.Squared \n    0.224 \n    0.227 \n    0.224 \n    0.224 \n    0.227 \n    0.227 \n  \n  \n    N.Obs \n    1322972 \n    1272400 \n    1322972 \n    1322972 \n    1272400 \n    1272400 \n  \n  \n    BIC \n    1635929 \n    2858301 \n    1635938 \n    1635938 \n    2858315 \n    2858315 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeEst.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate(est = ifelse(grepl(\"nb|log\", spec) == F, est*25, (exp(est)-1)*1000))\ntab = tab %>% mutate(se = ifelse(grepl(\"nb|log\", spec) == F, se*25, (exp(se)-1)*1000))\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"OLS\", \"Log-Linear OLS \", \"Negative Binomial\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 7:  Effects of air pollution on criminality across different estimators \n \n\n\nMexico City\nNew York\n\n  \n     \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n  \n \n\n  Linear Model\n\n    Linear \n    0.005 ** \n    0.088 *** \n    0.329 *** \n    0.009 ** \n    0.157 *** \n    0.502 *** \n  \n  \n     \n    (0.002) \n    (0.026) \n    (0.115) \n    (0.004) \n    (0.055) \n    (0.069) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784659 \n    797576 \n    1634911 \n    3869900 \n    1612538 \n    2847884 \n  \n  Quadratic Model\n\n    Linear \n    0.007 * \n    0.141 * \n    1.256 *** \n    0.027 *** \n    0.481 *** \n    1.128 *** \n  \n  \n     \n    (0.004) \n    (0.070) \n    (0.205) \n    (0.009) \n    (0.131) \n    (0.197) \n  \n  \n    Quadratic \n    -0.000 \n    -0.000 \n    -0.004 *** \n    -0.000 ** \n    -0.003 *** \n    -0.005 *** \n  \n  \n     \n    (0.000) \n    (0.000) \n    (0.001) \n    (0.000) \n    (0.001) \n    (0.001) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784671 \n    797587 \n    1634895 \n    3869892 \n    1612524 \n    2847882 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/RobustSpecs.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"(1)\", \"(2) \", \"(3)\", \"(4)\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 8:  Robustness exercises on the effects of air pollution on criminality \n \n\n\nMexico City\nNew York\n\n  \n     \n    (1) \n    (2)  \n    (3) \n    (4) \n    (1) \n    (2)  \n    (3) \n    (4) \n  \n \n\n  Linear Model\n\n    Linear \n    0.262 *** \n    0.228 ** \n    0.228 ** \n    0.084 \n    0.459 *** \n    0.598 *** \n    0.584 *** \n    0.723 *** \n  \n  \n     \n    (0.100) \n    (0.109) \n    (0.109) \n    (0.214) \n    (0.072) \n    (0.086) \n    (0.087) \n    (0.161) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516118 \n    717986 \n    717986 \n    254487 \n    2728597 \n    2098240 \n    1879357 \n    994447 \n  \n  Quadratic Model\n\n    Linear \n    1.248 *** \n    1.595 *** \n    1.595 *** \n    1.356 ** \n    1.079 *** \n    1.335 *** \n    1.423 *** \n    1.331 ** \n  \n  \n     \n    (0.226) \n    (0.290) \n    (0.290) \n    (0.647) \n    (0.196) \n    (0.327) \n    (0.323) \n    (0.602) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.006 *** \n    -0.006 *** \n    -0.006 ** \n    -0.005 *** \n    -0.006 *** \n    -0.007 *** \n    -0.005 \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.003) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.004) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516098 \n    717980 \n    717980 \n    254497 \n    2728593 \n    2098239 \n    1879356 \n    994459 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(`Linear Model` = read_rds(paste0(file, \"02_GenData/04_results/LinearDynamic.rds\")),\n          `Quadratic Model` = read_rds(paste0(file, \"02_GenData/04_results/QuadraticDynamic.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\")\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", model)) %>% \n  mutate(col = paste(sample, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", model)) %>% \n  mutate(col = paste(sample, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"Lag 1\", \"Lag 4\", \"Lag 8\", \"Lag 16\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from distributed lag non-linear model estimates with Poisson pseudo-maximum likelihood estimators. We present results for models across four lag structures (1, 4, 8, and 16 hours before the crime). All estimates contain weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level..\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 9:  Effects of air pollution on criminality for different lag models \n \n\n\nMexico City\nNew York\n\n  \n     \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n  \n \n\n  Linear Model\n\n    Linear \n    0.188 \n    0.193 * \n    0.114 \n    0.099 \n    0.558 *** \n    0.612 *** \n    0.728 *** \n    0.658 *** \n  \n  \n     \n    (0.143) \n    (0.110) \n    (0.083) \n    (0.083) \n    (0.095) \n    (0.100) \n    (0.113) \n    (0.126) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0.220 \n    0.220 \n    0.220 \n    0.220 \n    0.224 \n    0.224 \n    0.224 \n    0.224 \n  \n  Quadratic Model\n\n    Linear \n    1.173 *** \n    0.930 *** \n    0.908 *** \n    0.927 *** \n    1.352 *** \n    1.542 *** \n    1.546 *** \n    1.501 *** \n  \n  \n     \n    (0.307) \n    (0.291) \n    (0.304) \n    (0.315) \n    (0.264) \n    (0.273) \n    (0.294) \n    (0.344) \n  \n  \n    Quadratic \n    -0.005 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 *** \n    -0.007 *** \n    -0.008 *** \n    -0.007 *** \n    -0.007 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n    (0.003) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n  \n\n\nNote:   $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from distributed lag non-linear model estimates with Poisson pseudo-maximum likelihood estimators. We present results for models across four lag structures (1, 4, 8, and 16 hours before the crime). All estimates contain weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level..\n\n\n\n\n\n\n\n\n\n\nAppendix\n\nFigure A1: Bar plot on the number of stations per year in Mexico City and New York.\nFigure A2: Color coded health risks for the EPA air quality index.\nTable A1: Effects of air pollution on criminality across different specifications of weather covariates.\nTable A2: Effects of air pollution on criminality across different clustering of standard errors.\nFigure A3: Box plots of raw and IV-fitted values of the NowCast AQI\n\n\nFigure A1Figure A2Table A1Table A2Figure A3\n\n\n\n\nShow the Code\n# Determine the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Set the data for the plot\nplot = data %>% group_by(city, year) %>% \n  summarise(stations = length(unique(station))) %>% \n  mutate(city = ifelse(grepl(\"nyc\", city), \"New York\", \"Mexico City\")) \n# Plot the number of stations per year for both cities\nggplot(plot) + \n  geom_bar(aes(x = year, y = stations), stat = \"identity\", fill = \"black\") +\n  theme(panel.background = element_rect(fill = \"transparent\"),\n        strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0),  legend.title = element_blank(), \n        legend.box.background = element_rect(fill = \"transparent\"),\n        legend.background = element_blank(), legend.key = element_rect(fill = \"transparent\"),\n        axis.line = element_line(), legend.position = c(0.85, 0.7))  +\n  ggpubr::grids() + labs(x = \"Year\", y = \"Number of Stations\") + facet_wrap(~city, scales = \"free\") +\n  scale_x_continuous(breaks= scales::pretty_breaks()) \n\n\n\n\n\nFigure 10: Number of stations per year\n\n\n\n\n\n\n\n\n\nFigure 11: Color coded health risks for the EPA air quality index\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeWeatherEst.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(col = paste(city, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(col = paste(city, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"(1)\", \"(2)\", \"(3)\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I report coefficients for three different specifications of weather covariates. (1) has not weather controls, (2) includes temperature, relative humidity, precipitation, and wind speed linearly, and (3) further adds the square value of temperature and precipitation. Point estimates come PMLE panel models with year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients as percentage changes in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"600px\") \n\n\n\n\nTable 10:  Effects of air pollution on criminality across different specifications of weather covariates \n \n\n\nMexico City\nNew York\n\n  \n     \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  Linear Model\n\n    Linear \n    0.324 *** \n    0.314 *** \n    0.292 ** \n    0.658 *** \n    0.638 *** \n    -0.003 \n  \n  \n     \n    (0.125) \n    (0.118) \n    (0.118) \n    (0.082) \n    (0.057) \n    (0.081) \n  \n  \n    N.Obs \n    1324983 \n    1324983 \n    1324983 \n    1272440 \n    1510133 \n    1272440 \n  \n  \n    BIC \n    1638094.241 \n    1638126.991 \n    1638080.024 \n    2862036.131 \n    3395871.284 \n    2863164.939 \n  \n  Quadratic Model\n\n    Linear \n    1.273 *** \n    1.358 *** \n    1.334 *** \n    1.531 *** \n    0.535 ** \n    1.125 *** \n  \n  \n     \n    (0.215) \n    (0.194) \n    (0.192) \n    (0.180) \n    (0.211) \n    (0.202) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.005 *** \n    -0.005 *** \n    -0.008 *** \n    -0.004 *** \n    -0.004 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n  \n  \n    N.Obs \n    1324983 \n    1324983 \n    1324983 \n    1510133 \n    1272440 \n    1272440 \n  \n  \n    BIC \n    1638102 \n    1638048 \n    1638067 \n    3395836 \n    2863164 \n    2862039 \n  \n\n\nNote:   $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I report coefficients for three different specifications of weather covariates. (1) has not weather controls, (2) includes temperature, relative humidity, precipitation, and wind speed linearly, and (3) further adds the square value of temperature and precipitation. Point estimates come PMLE panel models with year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients as percentage changes in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeRobustSe.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(col = paste(city, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(col = paste(city, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"Station-by-month\", \"Station-by-Week\", \"Station-by-Date\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from OLS and log-linear OLS panel models with weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients in the OLS model as the marginal effect of increasing each particle by one hundred units and in the log-linear design as percentage changes in the number of crimes due to a ten units increase in the NowcAST aqi--standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"600px\") \n\n\n\n\nTable 11:  Effects of air pollution on criminality across different clustering of standard errors \n \n\n\nMexico City\nNew York\n\n  \n     \n    Station-by-month \n    Station-by-Week \n    Station-by-Date \n    Station-by-month \n    Station-by-Week \n    Station-by-Date \n  \n \n\n  Linear Model\n\n    Linear \n    0.327 ** \n    0.327 ** \n    0.327 ** \n    0.477 *** \n    0.477 *** \n    0.477 *** \n  \n  \n     \n    (0.131) \n    (0.133) \n    (0.135) \n    (0.102) \n    (0.125) \n    (0.105) \n  \n  \n    N.Obs \n    1324983 \n    1324983 \n    1324983 \n    1272440 \n    1272440 \n    1272440 \n  \n  \n    BIC \n    1638412.393 \n    1638412.393 \n    1638412.393 \n    2862655.689 \n    2862655.689 \n    2862655.689 \n  \n  Quadratic Model\n\n    Linear \n    1.238 *** \n    1.238 *** \n    1.238 *** \n    1.090 *** \n    1.090 *** \n    1.090 *** \n  \n  \n     \n    (0.251) \n    (0.260) \n    (0.258) \n    (0.264) \n    (0.268) \n    (0.264) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.004 *** \n    -0.004 *** \n    -0.005 *** \n    -0.005 *** \n    -0.005 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n  \n  \n    N.Obs \n    1324983 \n    1324983 \n    1324983 \n    1272440 \n    1272440 \n    1272440 \n  \n  \n    BIC \n    1638394 \n    1638394 \n    1638394 \n    2862651 \n    2862651 \n    2862651 \n  \n\n\nNote:   $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from OLS and log-linear OLS panel models with weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients in the OLS model as the marginal effect of increasing each particle by one hundred units and in the log-linear design as percentage changes in the number of crimes due to a ten units increase in the NowcAST aqi--standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Split the data\ndata = split(data, f = data$city)\n#### Only keep the variables relevant for the regression design ####\ndata = lapply(data, function(x) \n  select(x, date, total, NowCast, wsp, rh, rh_ntile, wdr8,\n         station, year, month, hour, weekday, temp_ntile, rain_ntile))\n# Run the first stage estimates of the NowCast as a function of wind direction\nest = lapply(data, function(x) \n  fepois(NowCast ~ wsp + rh | station^year^month + hour^station + weekday +\n           temp_ntile + rain_ntile + rh_ntile^temp_ntile + wdr8^station, data = x))\n# Extract the fitted values of the NowCast index\npredict = lapply(est, function(x) data.frame(NowCastIv = fitted.values(x, na.rm = F)))\n# Add the fitted AQI to the original data\ndata$cdmx = cbind(data$cdmx, predict$cdmx)\ndata$nyc = cbind(data$nyc, predict$nyc); rm(predict)\n# Plot the box-plotm\nplot = select(rbindlist(data, idcol = \"city\"), station, date, hour, city, NowCast, NowCastIv)\n# Transform to long format\nplot = gather(plot, variable, value, -c(station:city))\n# Restrict to the first and 99th percentile of the distribution\nplot = ungroup(plot) %>% group_by(city, variable) %>% \n  filter(value < quantile(value, 0.99, na.rm = T), \n         value > quantile(value, 0.01, na.rm = T))\n# Change the name of the cities\nplot = mutate(plot, city = ifelse(city == \"nyc\", \"New York City\", \"Mexico City\"), \n              variable = ifelse(variable == \"NowCast\", \"Raw AQI\", \"Instrumented AQI\"))\n# Construct the ggplot\nggplot(plot)  + geom_boxplot(aes(x = variable, y = value, fill = variable), outlier.shape = NA) +\n  theme(panel.background = element_rect(fill = \"transparent\"),\n        strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0), axis.line = element_line(), \n        legend.position = \"bottom\", legend.title = element_blank())  +\n  grids(color = \"gray80\") + labs(x = \"\", y = \"\") + guides(fill = FALSE) +\n  facet_wrap(~city, scales = \"free\") + \n  scale_fill_manual(values = c(\"antiquewhite\", \"darkorange\"))\n\n\n\n\n\nFigure 12: Box plots of raw and IV-fitted values of the NowCast AQI\n\n\n\n\nNotes: Box plots of raw and IV-fitted air pollution values. The box lines represent the median, 10th, and 90th percentile, while the Whiskers upper and lower limits are the 1st and 99th percentiles of the distribution."
  },
  {
    "objectID": "01_about.html",
    "href": "01_about.html",
    "title": "About",
    "section": "",
    "text": "This research report contains three primary sections to accompany the study on the relationship between air pollution exposure and criminal behaviour in Mexico City and New York."
  },
  {
    "objectID": "01_about.html#replication",
    "href": "01_about.html#replication",
    "title": "About",
    "section": "Replication",
    "text": "Replication\nAll the raw files needed to run the code are in the dropbox repository\nIf you want to replicate the study, download all files in the dropbox repository while considering the space constraints in your computer.1\nThe files in the repository have a folder-like structure with the following key sections:\n\n01_RawData – Includes the raw data files divided into four main folders\n\n01_crimes -It is the repository with all the raw data on criminality for Mexico City and New York. It contains two sub-directories. 01_nyc has all the crime data forNew York City (in CSV and Excel formats), and 03_cdmx has comparable data from Mexico City. 03_cdmx is further divided into two different CSV files (one between 2012 and 2015 and the other between 2016 and 2019).\n02_pollution - Repository with all the air pollution data for New York and Mexico City. It contains two sub-directories. 01_epa contains the air pollution data from the network of monitoring stations maintained by the US Environmental Protection Agency. This folder contains two additional folders;* 02_daily* contains zipped daily measurements of air pollution between 2000 and 2019 for the entire USA, and 02_StateData contains zipped files of hourly air pollution across American states. Next, 03_cdmx contains the air pollution data for Mexico City across three repositories; 01_pol has a set of CSV files with hourly air pollution data. 02_weather has a similar structure for weather controls. And 03_other contains a folder with the geographical location of measuring stations.\n03_shapefiles – Folder with all the shape (spatial) files I use throughout the study. One for the boroughs in New York City and another one for the Mexican States.\n04_weather - Folder with the weather data for New York City\n\n02_GenData – Contains the set of data frames I use for the estimation of point estimates. Each data-file comes from the scientific manipulation of the raw data in the 01_RawFiles repository. I divide the repository into four folders:\n\n01_crime: the folder contains three main files:\n\nCrimesCdmx.rds: Crime data for Mexico City\nCrimesNYC.rds: Crime data for New York City\ncrimes.rds: Crime data for Mexico City and New York\n\n02_pol: The folder contain 6 files\n\nPolCdmx.rds: Air pollution data for Mexico City\nPolWeatherCdmx.rds: Air pollution and weather data for Mexico City\npolNYC.rds: Hourly pollution data for New York City\nRawWeatherNYC.rds: Hourly weather data for New York City\nPolWeatherNYC.rds: Air pollution and weather data for New York City\nRawPol.rds: Air pollution and weather data for Mexico City and New York\nIdwPol.rds: Inverse distance weighted pollution data for both cities\nPolReg.rds: Final data frame with hourly air pollution, weather, and AQI values\n\n03_RegData: Contains the files I use in the econometric analysis\n\nDataReg: It is the main file\nDataRobustness: Additional data for robustness exercises\n\n04_results: Contains all the results from the econometric specifications. Each result comes from the file 03_scripts/04_reg.R script.\n\n03_scripts – Here, I include all the R-scripts I use to transform the raw data into a useful format, perform descriptive statistics, and run my empirical specifications. I divide the scripts into tasks, particularly:\n\n01_crimes – Transforms and cleans the raw crime data into the format necessary to use in the empirical design\n02_pol – Transforms and cleans the air pollution and weather variables\n03_RegData – Merges the crime and air pollution data according to the specifications of the stury\n04_reg - Contains all the econometric analysis\n05_tab - Generates (one by one) all of the tables in the study\n06_plot - Generates (one by one) all of the figures in the study\n99_robustness – Includes all robustness exercises"
  },
  {
    "objectID": "02_exhibits.html#section",
    "href": "02_exhibits.html#section",
    "title": "Study Exhibits",
    "section": "",
    "text": "Results section\nTable 1 contains the coefficients on the linear effect of the Now Cast AQI on crime counts in New York and Mexico City. Table 2 contains the coefficients of the quadratic model estimating the relationship between pollution and criminality in Mexico city and New York. Table 3 contains the coefficients of the linear and quadratic models on the relationship between pollution and criminality for violent and nonviolent crimes in Mexico city and New York. Table 4 contains the estimates on the effects across all crime categories.\n\nTable 2Table 3Table 4Table 5\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"/02_GenData/04_results/PoissonLinear.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Estimate\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\", general_title = \"Notes:\", footnote_as_chunk = T)\n\n\n\n\nTable 1:  Effect of pollution on criminality (linear model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Estimate \n    0.197 * \n    0.272 ** \n    0.327 ** \n    0.363 *** \n    0.420 *** \n    0.477 *** \n  \n  \n     \n    (0.111) \n    (0.117) \n    (0.131) \n    (0.109) \n    (0.102) \n    (0.102) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618359 \n    1638412 \n    2844555 \n    2844488 \n    2862656 \n  \n\n\nNotes:  $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadratic.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Linear\", \" \", \"Quadratic\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 5, 7) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T)\n\n\n\n\nTable 2:  Effect of pollution on criminality (quadratic model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Linear \n    0.779 *** \n    1.012 *** \n    1.238 *** \n    0.819 *** \n    0.914 *** \n    1.090 *** \n  \n  \n     \n    (0.252) \n    (0.240) \n    (0.251) \n    (0.292) \n    (0.276) \n    (0.264) \n  \n  \n    Quadratic \n    -0.003 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 * \n    -0.004 ** \n    -0.005 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618352 \n    1638394 \n    2844558 \n    2844490 \n    2862651 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticViolent.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Change the names of the types of crime ####\ntab = mutate(tab, dependent = mgsub(dependent, c(\"NonViolent\"), c(\"Non Violent\")))\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\nviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(violent) = c(\"names\", \"\", \" \", \"N.obs\", \"R2\", \"BIC\") \nviolent = select(violent, -V1); colnames(violent) = violent[1,]; violent = violent[-1, ]\n# Create the data-frame for the html table\nnonviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Non Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(nonviolent) = c(\"names\", \"  \", \"   \", \"N.obs \", \"R2 \", \"BIC \") \nnonviolent = select(nonviolent, -V1); colnames(nonviolent) = nonviolent[1,]; nonviolent = nonviolent[-1, ]\n#\nhtml = rbind(violent ,nonviolent)\n# change the column names \ncolnames(html) = paste0(\"(\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2), \")\")\n# Create the HTML table of the first figure\nkbl(html, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n   pack_rows(\"Violent\", 1, 5) %>%\n  pack_rows(\"Non Violent\", 6, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 3:  Estimates on the effects of air pollution for violent and non-violent crimes \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n    (Linear) \n    (Linear) \n    (Quadratic) \n    (Linear) \n    (Linear) \n    (Quadratic) \n  \n \n\n  Violent\n\n     \n    0.240 * \n    1.556 *** \n    -0.006 *** \n    0.797 *** \n    1.314 ** \n    -0.004 \n  \n  \n     \n    (0.130) \n    (0.304) \n    (0.001) \n    (0.168) \n    (0.517) \n    (0.004) \n  \n  \n    N.obs \n    0.130 \n    0.130 \n    0.130 \n    0.125 \n    0.125 \n    0.125 \n  \n  \n    R2 \n    1322488 \n    1322488 \n    1322488 \n    1244562 \n    1244562 \n    1244562 \n  \n  \n    BIC \n    870538 \n    870529 \n    870529 \n    1085029 \n    1085040 \n    1085040 \n  \n  Non Violent\n\n     \n    0.197 \n    0.704 * \n    -0.002 * \n    0.317 *** \n    0.546 * \n    -0.002 \n  \n  \n     \n    (0.172) \n    (0.407) \n    (0.001) \n    (0.097) \n    (0.291) \n    (0.002) \n  \n  \n    N.obs \n    0.219 \n    0.219 \n    0.219 \n    0.189 \n    0.189 \n    0.189 \n  \n  \n    R2 \n    1300287 \n    1300287 \n    1300287 \n    1271109 \n    1271109 \n    1271109 \n  \n  \n    BIC \n    777428 \n    777439 \n    777439 \n    1597431 \n    1597444 \n    1597444 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticOtherCrimes.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2))\ntab = tab[-1,]\ntab = tab[-c(16,17,18),]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 2, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 4:  Estimates on the effects of air pollution across different crime categories \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n     \n    Linear \n    Linear \n    Quadratic \n    Linear \n    Linear \n    Quadratic \n  \n \n\n  \n    2 \n    Burglary \n    0.340 \n    0.214 \n    0.001 \n    0.169 \n    -0.256 \n    0.004 \n  \n  \n    3 \n     \n    (0.304) \n    (0.871) \n    (0.004) \n    (0.186) \n    (0.571) \n    (0.004) \n  \n  \n    4 \n    Homicide \n    0.521 \n    4.562 ** \n    -0.019 *** \n    0.084 \n    -9.775 \n    0.089 \n  \n  \n    5 \n     \n    (0.850) \n    (1.824) \n    (0.007) \n    (12.396) \n    (25.925) \n    (0.132) \n  \n  \n    6 \n    Robbery \n    0.238 * \n    1.437 *** \n    -0.005 *** \n    0.395 \n    1.614 * \n    -0.010 \n  \n  \n    7 \n     \n    (0.137) \n    (0.346) \n    (0.002) \n    (0.281) \n    (0.887) \n    (0.007) \n  \n  \n    8 \n    Larceny \n    -0.018 \n    0.256 \n    -0.001 \n    0.293 ** \n    0.529 * \n    -0.002 \n  \n  \n    9 \n     \n    (0.124) \n    (0.492) \n    (0.002) \n    (0.126) \n    (0.319) \n    (0.002) \n  \n  \n    10 \n    SexCrime \n    0.497 \n    3.099 ** \n    -0.012 * \n    0.411 *** \n    0.866 *** \n    -0.004 * \n  \n  \n    11 \n     \n    (0.374) \n    (1.534) \n    (0.006) \n    (0.148) \n    (0.299) \n    (0.002) \n  \n  \n    12 \n    fraud \n    0.336 \n    1.580 * \n    -0.005 * \n    0.339 \n    0.586 \n    -0.002 \n  \n  \n    13 \n     \n    (0.243) \n    (0.917) \n    (0.003) \n    (0.318) \n    (1.173) \n    (0.009) \n  \n  \n    14 \n    other \n    0.633 *** \n    1.289 *** \n    -0.003 ** \n    0.402 ** \n    1.287 ** \n    -0.007 ** \n  \n  \n    15 \n     \n    (0.128) \n    (0.368) \n    (0.001) \n    (0.183) \n    (0.521) \n    (0.004) \n  \n  \n    16 \n    R.Squared \n    0.147 \n    0.147 \n    0.147 \n    0.167 \n    0.167 \n    0.167 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\n\nRobustness section\nTable 5 contains the main results of the IV strategy\n\nTable 6Table 7Table 8Table 9\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(read_rds(paste0(file, \"/02_GenData/04_results/99_iv/LinearWdr8.rds\")),\n          read_rds(paste0(file, \"/02_GenData/04_results/99_iv/QuadWdr8.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\") %>%\n  mutate(var = ifelse(grepl(\"2\", var), \"Quadratic\", \"Linear\"))\n#### Take the exponent of the point estimates ####\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Split the data set by the distinct specifications ####\ntab = mutate(tab, city = paste(model, city, var))\ntab = split(tab, f = tab$city)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = y),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\",\"Linear\", \"Linear \", \"Linear  \", \"Quadratic\", \" Linear\", \"Quadratic \")\nrownames(tab) = c(\"   \",\"\", \" \", \"R.Squared\", \"N.Obs\", \"BIC\"); tab = tab[-1,-1]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 1, \"New York\" = 1, \"Mexico City\" = 2, \"New York\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 2, \"Quadratic Model\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 5:  Effects of air pollution on criminality (IV) \n \n\n\nLinear Model\nQuadratic Model\n\n\n\nMexico City\nNew York\nMexico City\nNew York\n\n  \n      \n    Linear \n    Linear  \n    Linear   \n    Quadratic \n     Linear \n    Quadratic  \n  \n \n\n  \n     \n    0.327 \n    1.038 *** \n    2.139 *** \n    -0.006 ** \n    1.542 ** \n    -0.004 \n  \n  \n     \n    (0.309) \n    (0.186) \n    (0.584) \n    (0.002) \n    (0.612) \n    (0.006) \n  \n  Fitted-Statistics\n\n    R.Squared \n    0.224 \n    0.227 \n    0.224 \n    0.224 \n    0.227 \n    0.227 \n  \n  \n    N.Obs \n    1322972 \n    1272400 \n    1322972 \n    1322972 \n    1272400 \n    1272400 \n  \n  \n    BIC \n    1635929 \n    2858301 \n    1635938 \n    1635938 \n    2858315 \n    2858315 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeEst.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate(est = ifelse(grepl(\"nb|log\", spec) == F, est*25, (exp(est)-1)*1000))\ntab = tab %>% mutate(se = ifelse(grepl(\"nb|log\", spec) == F, se*25, (exp(se)-1)*1000))\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"OLS\", \"Log-Linear OLS \", \"Negative Binomial\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 6:  Effects of air pollution on criminality across different estimators \n \n\n\nMexico City\nNew York\n\n  \n     \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n  \n \n\n  Linear Model\n\n    Linear \n    0.005 ** \n    0.088 *** \n    0.329 *** \n    0.009 ** \n    0.157 *** \n    0.502 *** \n  \n  \n     \n    (0.002) \n    (0.026) \n    (0.115) \n    (0.004) \n    (0.055) \n    (0.069) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784659 \n    797576 \n    1634911 \n    3869900 \n    1612538 \n    2847884 \n  \n  Quadratic Model\n\n    Linear \n    0.007 * \n    0.141 * \n    1.256 *** \n    0.027 *** \n    0.481 *** \n    1.128 *** \n  \n  \n     \n    (0.004) \n    (0.070) \n    (0.205) \n    (0.009) \n    (0.131) \n    (0.197) \n  \n  \n    Quadratic \n    -0.000 \n    -0.000 \n    -0.004 *** \n    -0.000 ** \n    -0.003 *** \n    -0.005 *** \n  \n  \n     \n    (0.000) \n    (0.000) \n    (0.001) \n    (0.000) \n    (0.001) \n    (0.001) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784671 \n    797587 \n    1634895 \n    3869892 \n    1612524 \n    2847882 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/RobustSpecs.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"(1)\", \"(2) \", \"(3)\", \"(4)\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 7:  Robustness exercises on the effects of air pollution on criminality \n \n\n\nMexico City\nNew York\n\n  \n     \n    (1) \n    (2)  \n    (3) \n    (4) \n    (1) \n    (2)  \n    (3) \n    (4) \n  \n \n\n  Linear Model\n\n    Linear \n    0.262 *** \n    0.228 ** \n    0.228 ** \n    0.084 \n    0.459 *** \n    0.598 *** \n    0.584 *** \n    0.723 *** \n  \n  \n     \n    (0.100) \n    (0.109) \n    (0.109) \n    (0.214) \n    (0.072) \n    (0.086) \n    (0.087) \n    (0.161) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516118 \n    717986 \n    717986 \n    254487 \n    2728597 \n    2098240 \n    1879357 \n    994447 \n  \n  Quadratic Model\n\n    Linear \n    1.248 *** \n    1.595 *** \n    1.595 *** \n    1.356 ** \n    1.079 *** \n    1.335 *** \n    1.423 *** \n    1.331 ** \n  \n  \n     \n    (0.226) \n    (0.290) \n    (0.290) \n    (0.647) \n    (0.196) \n    (0.327) \n    (0.323) \n    (0.602) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.006 *** \n    -0.006 *** \n    -0.006 ** \n    -0.005 *** \n    -0.006 *** \n    -0.007 *** \n    -0.005 \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.003) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.004) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516098 \n    717980 \n    717980 \n    254497 \n    2728593 \n    2098239 \n    1879356 \n    994459 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(`Linear Model` = read_rds(paste0(file, \"02_GenData/04_results/LinearDynamic.rds\")),\n          `Quadratic Model` = read_rds(paste0(file, \"02_GenData/04_results/QuadraticDynamic.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\")\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", model)) %>% \n  mutate(col = paste(sample, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", model)) %>% \n  mutate(col = paste(sample, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"Lag 1\", \"Lag 4\", \"Lag 8\", \"Lag 16\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 8:  Effects of air pollution on criminality for different lag models \n \n\n\nMexico City\nNew York\n\n  \n     \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n  \n \n\n  Linear Model\n\n    Linear \n    0.188 \n    0.193 * \n    0.114 \n    0.099 \n    0.558 *** \n    0.612 *** \n    0.728 *** \n    0.658 *** \n  \n  \n     \n    (0.143) \n    (0.110) \n    (0.083) \n    (0.083) \n    (0.095) \n    (0.100) \n    (0.113) \n    (0.126) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0.220 \n    0.220 \n    0.220 \n    0.220 \n    0.224 \n    0.224 \n    0.224 \n    0.224 \n  \n  Quadratic Model\n\n    Linear \n    1.173 *** \n    0.930 *** \n    0.908 *** \n    0.927 *** \n    1.352 *** \n    1.542 *** \n    1.546 *** \n    1.501 *** \n  \n  \n     \n    (0.307) \n    (0.291) \n    (0.304) \n    (0.315) \n    (0.264) \n    (0.273) \n    (0.294) \n    (0.344) \n  \n  \n    Quadratic \n    -0.005 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 *** \n    -0.007 *** \n    -0.008 *** \n    -0.007 *** \n    -0.007 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n    (0.003) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level."
  },
  {
    "objectID": "01_DataFiles.html",
    "href": "01_DataFiles.html",
    "title": "Data Sets",
    "section": "",
    "text": "This page presents an overall description of the data sets I use to analyze the effect of air pollution on criminality for New York and Mexico City.\nResearchers can access the data I use to generate these files in the dropbox repository"
  },
  {
    "objectID": "01_DataFiles.html#new-york-city",
    "href": "01_DataFiles.html#new-york-city",
    "title": "Data Sets",
    "section": "New York City",
    "text": "New York City\n\n\n\nWe obtain data on NYC criminality from the open data-portal website of New York City. I transform the raw data into a panel format with the first code-chunk of the script 03_scripts/01_crime in the dropbox folder. Table 1 shows the structure of the data. There are 5,995,453 observations. The data set spans from Jan 2006 to Dec 2017. It contains, the crime date, hour, longitude, and latitude, alongside a categorical variable indicating the type of crime. This variable can take the following values: Assault, Burglary, Fraud, Forgery, and Bribery, Larceny, Liberty crimes, Mansloughter, Other, Rape, Robbery, Sex crime, Simple Assault.\n\n\n\n\nTable 1:  Structure of the NYC crime data \n \n  \n    date \n    hour \n    lat \n    lon \n    crime \n  \n \n\n  \n    2011-06-18 \n    21 \n    40.72 \n    -73.95 \n    Other \n  \n  \n    2011-06-18 \n    21 \n    40.69 \n    -73.82 \n    Other \n  \n  \n    2011-06-18 \n    21 \n    40.76 \n    -73.98 \n    Fraud, Forgery, and Bribery \n  \n\n\nNotes:  Sample of the criminality data for New York City. Each observation contains the date, hour, longitude, and latitude of all crimes occuring in the city between 2012 and 2018 alngside a categorical varible indicating the type of crime"
  },
  {
    "objectID": "01_DataFiles.html#mexico-city",
    "href": "01_DataFiles.html#mexico-city",
    "title": "Data Sets",
    "section": "Mexico City",
    "text": "Mexico City\n\n\n\nThe data set for Mexico City comes from the open-data portal of the Mexico City Government for the years between 2016 and 2019 and from citizen requests from the observations between 2012 and 2015. Table 2 shows the structure of the data. There are 1,563,833 observations. The data set spans from Jan 2012 to Dec 2019. It contains, the crime date, hour, longitude, and latitude, alongside a categorical variable indicating the type of crime. This variable can take the following values: Assault, Burglary, Fraud, Forgery, and Bribery, Homicide, Larceny, Liberty crimes, Mansloughter, Other, Rape, Robbery, Sex crime, Simple Assault.\n\n\n\n\nTable 2:  Structure of the CDMX crime data \n \n  \n    date \n    hour \n    lat \n    lon \n    crime \n  \n \n\n  \n    2012-01-02 \n    5 \n    19.41 \n    -99.13 \n    Robbery \n  \n  \n    2012-01-03 \n    15 \n    19.43 \n    -99.09 \n    Robbery \n  \n  \n    2012-01-01 \n    14 \n    19.39 \n    -99.16 \n    Robbery \n  \n\n\nNotes:  Sample of the criminality data for New York City. Each observation contains the date, hour, longitude, and latitude of all crimes occuring in the city between 2012 and 2018 alngside a categorical varible indicating the type of crime"
  },
  {
    "objectID": "01_DataFiles.html#mexico-city-1",
    "href": "01_DataFiles.html#mexico-city-1",
    "title": "Data Sets",
    "section": "Mexico City",
    "text": "Mexico City\n\n\n\nI obtain the hourly data on pollution for Mexico City from the Atmospheric Information Center of the city. The data contains station-level measurements of the key criteria pollutants and weather covariates. In total, it contains 2,673,312 hourly observations divided across 47 measuring stations spanning from Jan 2010 to Dec 2019. Table 3 portrays s sample of the panel with one observation for each station, date, and hour combinations. The file reports the longitude and latitude of the station alongside the concentrations of ozone (o3), fine particulate matter(pm25), coarse particulate matter (pm10), relative humidity (rh), temperature (temp), wind speed (wsp), and wind direction (wdr)\n\n\n\n\nTable 3:  Structure of the CDMX pollution data \n \n  \n    station \n    date \n    hour \n    lat \n    lon \n    o3 \n    pm25 \n    pm10 \n    rh \n    temp \n    wsp \n    wdr \n  \n \n\n  \n    ACO \n    2010-01-01 \n    0 \n    19.64 \n    -98.91 \n    11 \n    11 \n    NA \n    74.90 \n    10.13 \n    1.76 \n    347 \n  \n  \n    ACO \n    2010-01-01 \n    1 \n    19.64 \n    -98.91 \n    15 \n    62 \n    NA \n    56.64 \n    14.49 \n    1.20 \n    357 \n  \n  \n    ACO \n    2010-01-01 \n    2 \n    19.64 \n    -98.91 \n    20 \n    75 \n    NA \n    57.81 \n    14.08 \n    1.74 \n    348 \n  \n  \n    ACO \n    2010-01-01 \n    3 \n    19.64 \n    -98.91 \n    29 \n    54 \n    NA \n    54.44 \n    13.97 \n    2.96 \n    332 \n  \n  \n    ACO \n    2010-01-01 \n    4 \n    19.64 \n    -98.91 \n    29 \n    17 \n    NA \n    52.83 \n    13.59 \n    2.75 \n    349 \n  \n\n\nNotes:  Sample of the air pollution data for Mexico City. Each observation contains the station id ant the date and hour time stamps. It also includes the geo-location of measuring stations and the measures of ozone (o3), fine particulate matter (pm25), coarse particulate matter (pm10), relative humidity (rh), temperature (temp), wind speed (wsp), and wind direction(wdr). Ozone in particles per billion, particulate matters in micrograms per cubic metter, relative humidity in percentage, temperature in celsius, wind speed in knots, and wind direction in meteorological degrees"
  },
  {
    "objectID": "01_DataFiles.html#new-york-city-1",
    "href": "01_DataFiles.html#new-york-city-1",
    "title": "Data Sets",
    "section": "New York City",
    "text": "New York City\n\n\n\nI obtain the hourly pollution data for New York City from the EPA pre-generated data-files. The data is structured in a panel format with one observations per station and date-hour combinations. It covers the period from Jan 2000 to Dec 2019 and contains 8,528,826 hourly observations divided across 96 measuring stations. Table 4 portrays a sample of the panel whose variables are analogous to Table 3.\n\n\n\n\nTable 4:  Structure of the New York City pollution data \n \n  \n    station \n    date \n    hour \n    lat \n    lon \n    o3 \n    pm25 \n    pm10 \n    rh \n    temp \n    wsp \n    wdr \n  \n \n\n  \n    000236029 \n    2000-01-01 \n    0 \n    42.99 \n    -78.77 \n    15 \n    NaN \n    NaN \n    72 \n    2.22 \n    3.14 \n    102 \n  \n  \n    000236029 \n    2000-01-01 \n    1 \n    42.99 \n    -78.77 \n    16 \n    NaN \n    NaN \n    67 \n    2.22 \n    3.14 \n    107 \n  \n  \n    000236029 \n    2000-01-01 \n    2 \n    42.99 \n    -78.77 \n    14 \n    NaN \n    NaN \n    68 \n    2.22 \n    3.14 \n    104 \n  \n  \n    000236029 \n    2000-01-01 \n    3 \n    42.99 \n    -78.77 \n    9 \n    NaN \n    NaN \n    74 \n    1.67 \n    3.14 \n    109 \n  \n  \n    000236029 \n    2000-01-01 \n    4 \n    42.99 \n    -78.77 \n    10 \n    NaN \n    NaN \n    77 \n    1.67 \n    3.14 \n    104 \n  \n\n\nNotes:  Sample of the air pollution data for New York City. Each observation contains the station id ant the date and hour time stamps. It also includes the geo-location of measuring stations and the measures of ozone (o3), fine particulate matter (pm25), coarse particulate matter (pm10), relative humidity (rh), temperature (temp), wind speed (wsp), and wind direction(wdr). Ozone in particles per billion, particulate matters in micrograms per cubic metter, relative humidity in percentage, temperature in celsius, wind speed in knots, and wind direction in meteorological degrees"
  },
  {
    "objectID": "01_DataFiles.html#inverse-distance-weighting",
    "href": "01_DataFiles.html#inverse-distance-weighting",
    "title": "Data Sets",
    "section": "Inverse Distance Weighting",
    "text": "Inverse Distance Weighting\nOnce I download and clean the hourly pollution data for Mexico City and New York, I fill the missing values of stations not measuring specific contaminants with inverse distance weighting. IDW approximates the value of a point in space by weighting the measures of comparable neighbours. The following equation shows the mathematical formula behind the weighting.\n\\[\n\\frac{\\sum_{i}^{N}\\omega(dist_{ij})*pol_{it}}{\\sum_{i}^{N}\\omega(dist_{ij})} \\quad | \\quad pol_{it} \\rightarrow dist_{ij} = 0 \\quad | \\quad \\Longrightarrow \\omega(dist_{ij}) = \\frac{1}{distance(x_{i}, x_{j})^p}\n\\]\nIn it, \\(V_{jt}\\) is the weighted value at station \\(j\\) at time \\(t\\), \\(pol_{it}\\) is the value of pollution (or weather) at station~\\(i\\) at time~\\(t\\), \\(x_i\\) and \\(x_j\\) the geographical coordinates of station \\(i\\) and \\(j\\), and~\\(dist_{ij}\\) is the distance between stations. The power factor \\(p\\) modifies the weighting load; the greater \\(p\\), the greater the weight of closer stations. We use a weight of two, as recommended by for air pollution. Furthermore, we cut off stations farther away than twenty kilometres to focus on local variations."
  },
  {
    "objectID": "01_DataFiles.html#the-nowcast-air-quality-index",
    "href": "01_DataFiles.html#the-nowcast-air-quality-index",
    "title": "Data Sets",
    "section": "The NowCast Air Quality Index",
    "text": "The NowCast Air Quality Index\nTo obtain a single estimate on the effect of pollution on criminality, I transform the hourly concentration of ozone, coarse particle matter, and fine particulate matter into the now Cast Air Quality Index (NC-AQI). The NC-AQI is an hourly version of the standard air quality index used by the EPA since 1976 to communicate the health consequences of exacerbated air pollution. The idea behind the AQI is to transform the concentration of the main criteria pollutants into an easy-to-understand index value that runs between zero and five hundred units. The NC-AQI is different from the standard AQI because the latter is unsuitable when analysing hourly data as it is only valid in a 24 hours period. The idea of the NC-AQI is to better represent the hourly risks of exposure by weighing nearby hours more heavily than the simple running average used with the standard AQIs. For this, before transforming pollutant concentrations into the AQI, the algorithm transforms the hourly values of of ozone and paticle matters according to equation Equation 1.\n\\[\n  NowCast^i_{st}= \\frac{\\sum_{t = 1}^{T} w^{t-1} c^i_t}{\\sum_{t = 1}^{T} w^{t-1}} \\hspace{0.15cm} and  \\hspace{0.15cm} w^* = \\frac{c_{min}}{c_{max}}\n\\tag{1}\\]\nIn it, c\\(^{i}_{st}\\) is the observed concentration of pollutant \\(i\\) at station \\(s\\) in time \\(t\\). In cases when a station does not measure one of the three particles used to estimate the index, I use the inverse distance weighted value I estimate in the previous section. \\(w^*\\) is the weighting factor of each observation defined as the ratio of the minimum and maximum concentration value over the specific rolling average; eight hours for \\(o_3\\) and twelve hours for \\(pm_{10}\\) and \\(pm_{25}\\). In cases when the minimum weighting factor for \\(pm_{10}\\) and \\(pm_{25}\\) is lower than 0.5, the algorithm updates it to 0.5. Once I estimate transformed exposure values, I translate them into the AQI with equation Equation 2.\n\\[\nAQI^i_{st}= \\frac{[NowCast^{i}_{st} - NowCast^{i,min}] - [Aqi^{i, max} - Aqi^{i,min}]}{NowCast^{max} - NowCast^{min}} + Aqi^{min}  \n\\tag{2}\\]\nIn it, NowCast\\(^{i}_{st}\\) is the transformed exposure value of pollutant \\(i\\) at time \\(t\\) in station \\(s\\). NowCast\\(^{i,min}\\) and NowCast\\(^{i,max}\\) are the minimum and maximum break values of pollutant \\(i\\) corresponding to each of the five risk categories in which the EPA divides the AQI. Similarly, AQI\\(_{min}\\) and AQI\\(_{max}\\) are the minimum and maximum AQI threshold values for each of these five categories.1 At each point in time, the AQI in station \\(s\\) at time \\(t\\) is the highest across all measured contaminants in that station, i.e., \\(AQI_{st} = max(AQI^i_{st})\\)."
  }
]