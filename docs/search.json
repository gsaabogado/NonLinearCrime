[
  {
    "objectID": "02_exhibits.html",
    "href": "02_exhibits.html",
    "title": "Study Exhibits",
    "section": "",
    "text": "Theoretical Background\n\nFigure 1Figure 2(a)Figure 2(b)Figure 3\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Compute the different Poisson distributions\nplot = list(`0.25` = data.frame(value = stats::rpois(3000000, 0.25 )) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)),\n            \n            `0.5` = data.frame(value = stats::rpois(3000000, 0.5 )) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n            `0.75` = data.frame(value = stats::rpois(3000000, 0.75)) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n            `1.0` = data.frame(value = stats::rpois(3000000, 1)) %>% \n              group_by(value) %>% summarise(count = n()) %>% \n              mutate(count = count/sum(count)), \n            \n             `Real Sample` = data %>% group_by(value = total) %>% summarise(count = n())%>% \n              mutate(count = count/sum(count))) %>% rbindlist(., idcol = \"Lambda\")\n# Plot the empirical data and the different poisson distributions\nggplot(dplyr::filter(plot, value < 10)) + \n  geom_line(aes(x = value, y = count, color = Lambda)) +\n  geom_point(aes(x = value, y = count, color = Lambda)) +\n  theme(panel.background = element_rect(fill = \"transparent\"),\n        strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0),  legend.title = element_blank(), \n        legend.box.background = element_rect(fill = \"transparent\"),\n        legend.background = element_blank(), legend.key = element_rect(fill = \"transparent\"),\n        axis.line = element_line(), legend.position = c(0.85, 0.7))  +\n  ggpubr::grids() + labs(x = \"k\", y = \"P(Crimes = k)\") +\n  scale_x_continuous(breaks= scales::pretty_breaks()) +\n  scale_color_manual(values = c(\"gray20\", \"gray40\", \"gray60\", \"gray80\", \"orange\"))\n\n\n\n\n\nFigure 1: Probability mass function for different Poisson distributions\n\n\n\n\nNotes: This figure presents the probability mass function of this study’s primary data set on the number of hourly crimes occurring in the vicinity of pollution measuring stations in Mexico City and New York alongside four simulated Poisson distributions with variances equal to 0.25, 0.5, 0.75, and 1.0\n\n\n\n\nShow the Code\n# Construct the dummy data\ndata = data.frame(temp = seq(0,40,2), s = seq(0, 1, 0.05), p = seq(1, 0, -0.05)) |> \n  mutate(s_1 = s*p) |>  mutate(s_1 = ((s_1 - min(s_1))/(max(s_1)- min(s_1)))) |> \n  filter(temp <= 20)\n# Plot the function\nggplot() + geom_line(data = data, aes(x = temp, y = s_1)) + \n  geom_point(data = data, aes(x = temp, y = s_1)) + \n  theme(panel.background = element_blank(), axis.line = element_line(), axis.text = element_blank()) + ggpubr::grids() +\n  labs(x = \"V(t), C(t)\", y= \"m[V(t), C(t)]\") \n\n\n\n\n\nFigure 2: Relationship of the matching function with the number of victims and criminals\n\n\n\n\n\n\n\n\nShow the Code\n# Construct the simulated data\ndata = data.frame(temp = seq(0,40,2), s = seq(0, 1, 0.05), p = seq(1, 0, -0.05)) |> \n  mutate(s_1 = s*p*-1) |>  mutate(s_1 = ((s_1 - min(s_1))/(max(s_1)- min(s_1)))) |> \n  filter(temp <= 20)\n# Plot the function\nggplot() + geom_line(data = data, aes(x = temp, y = s_1)) + \n  geom_point(data = data, aes(x = temp, y = s_1)) + \n  theme(panel.background = element_blank(), axis.line = element_line(), axis.text = element_blank()) + ggpubr::grids() +\n  labs(y = \"V(t), C(t)\", x= \"Exposure to air Pollution\") \n\n\n\n\n\nFigure 3: relationship between exposure to air pollution and the number of victims and criminals\n\n\n\n\n\n\n\n\n\nFigure 4: Theoretical relationship between air pollution and crime; the red line marks the level of air pollution that maximizes criminality, i.e., \\(\\frac{\\partial crime}{\\partial pollution} = 0\\).\n\n\n\n\n\n\n\nDescriptive Statistics (Data section)\n\nFigure 4Figure 5\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data set\ndata = read_rds(paste0(file, \"02_GenData/03_RegData/DataReg.rds\"))\n# Aggregate to the hourly level\nhr = data %>% group_by(value = as.numeric(hour), city) %>% summarise(count = sum(total)) %>% \n  group_by(city) %>%  mutate(avg = mean(count, na.rm = T))%>%\n  mutate(dev = ((count-avg)/avg)*100) %>% mutate(variable = \"Hourly Variation\")\n# Aggregate to the monthly leve\nmo = data %>% group_by(value = as.numeric(month), city) %>% \n  summarise(count = sum(total))  %>% group_by(city) %>% mutate(avg = mean(count, na.rm = TRUE)) %>%\n  mutate(dev = ((count-avg)/avg)*100) %>% mutate(variable = \"Monthly Variation\")\n# Aggregate to the yearly leve\nye = data %>% group_by(value = as.numeric(year), city) %>% summarise(count = sum(total))  %>% \n  group_by(city) %>% mutate(avg = mean(count, na.rm = TRUE)) %>%\n  mutate(dev = ((count-avg)/avg)*100)%>% mutate(variable = \"Yearly Variation\") %>%\n  filter(value != 2006)\n# Rbindlist all data sets\ntemporal = rbindlist(list(hr, mo, ye)) %>% mutate(value = as.numeric(value))\n# Change the name of the city\ntemporal = mutate(temporal, city = ifelse(city == \"nyc\", \"New York City\", \"Mexico City\"))\n# Plot the deviation from the average\nggplot(temporal) + geom_line(aes(x = value, y = dev, color = city, group = city)) +\n  geom_point(aes(x = value, y = dev, color = city, group = city)) +\n  facet_wrap(~variable, scales = \"free\") +\n  theme(panel.background = element_rect(fill = \"transparent\"),strip.background = element_rect(fill = \"transparent\"),\n        strip.text = element_text(hjust = 0), axis.line = element_line(), legend.position = \"bottom\", \n        legend.title = element_blank(),)  +\n  ggpubr::grids() + labs(x = \"\", y = \"% Deviation from the mean\")  +\n  scale_color_manual(values = c(\"black\", \"darkorange\")) +\n  scale_x_continuous(breaks= scales::pretty_breaks())\n\n\n\n\n\nFigure 5: The grid shows the temporal behavior of criminality in Mexico City and New York. Clockwise it shows the hourly, monthly, and yearly variation concerning the average.\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n#### Load the dpatial data\nnyc = read_sf(paste0(file, \"01_RawData/03_shapefiles/NYC Buroughs\")) %>% \n  mutate(city = \"New York\") %>% select(city) \n\ncdmx = read_sf(paste0(file, \"01_RawData/03_shapefiles/States in Mexico\")) %>% \n  filter(ENTIDAD == \"DISTRITO FEDERAL\") %>% \n  mutate(city = \"Mexico City\") %>% select(city) %>% st_cast(., \"MULTIPOLYGON\")\n# Exclude stations with no crimes during the entire period\ndata = data %>% group_by(station) %>% filter(sum(total) != 0)\nPolSt = select(data, station, lon, lat) |> distinct()\n# Create a data set of stations for Mexico City\nstcdmx = select(data, station, lon, lat, city) %>% distinct()%>% filter(city == \"cdmx\") %>% \n  st_as_sf(., coords = c(\"lon\", \"lat\"), crs = st_crs(nyc)) \n# create a data set of stations\nstnyc = select(data, station, lon, lat, city) %>% distinct()%>% filter(city == \"nyc\") %>% \n  st_as_sf(., coords = c(\"lon\", \"lat\"), crs = st_crs(nyc)) \n# Transform the stations into a spatial set\nPolSt =  st_as_sf(PolSt, coords = c(\"lon\", \"lat\"), crs = 4326)\n# Aggregate the shapefiles of ploygons and stations in both cities\nshp = rbind(st_transform(nyc, crs = 4326), st_transform(cdmx, crs = 4326))\nst = rbind(stcdmx, stnyc)\n# Map the stations over Spain and Madrid\ntmap_style(\"classic\")\n\ntmap = tm_graticules(labels.cardinal = F, alpha = 0.5, , labels.size = 0.75) + \n  tm_shape(shp) + tm_polygons(col = \"black\") +\n  tm_facets(by = \"city\") + tm_shape(st) +\n  tm_dots(size = 0.1, col = \"white\") + tmap_options(check.and.fix = TRUE) +\n  tm_compass(type = \"rose\", position = c(\"left\", \"top\"), size = 3) +\n  tm_scale_bar(width = 0.20, position = c(\"left\", \"bottom\"), text.size = 0.75) +\n  tm_layout(legend.outside = F, legend.stack = \"horizontal\",\n            legend.position = c(\"left\", \"top\"), \n            inner.margins = c(0.05, 0.05, 0.05, 0.05)); tmap\n\n\n\n\n\n\n\n\n\n\nResults section\nTable 1 contains the coefficients on the linear effect of the Now Cast AQI on crime counts in New York and Mexico City. Table 2 contains the coefficients of the quadratic model estimating the relationship between pollution and criminality in Mexico city and New York. Table 3 contains the coefficients of the linear and quadratic models on the relationship between pollution and criminality for violent and nonviolent crimes in Mexico city and New York. Table 4 contains the estimates on the effects across all crime categories.\n\nTable 2Table 3Table 4Table 5\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"/02_GenData/04_results/PoissonLinear.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Estimate\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\", general_title = \"Notes:\", footnote_as_chunk = T)\n\n\n\n\nTable 1:  Effect of pollution on criminality (linear model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Estimate \n    0.197 * \n    0.272 ** \n    0.327 ** \n    0.363 *** \n    0.420 *** \n    0.477 *** \n  \n  \n     \n    (0.111) \n    (0.117) \n    (0.131) \n    (0.109) \n    (0.102) \n    (0.102) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618359 \n    1638412 \n    2844555 \n    2844488 \n    2862656 \n  \n\n\nNotes:  $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadratic.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Linear\", \" \", \"Quadratic\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 5, 7) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T)\n\n\n\n\nTable 2:  Effect of pollution on criminality (quadratic model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Linear \n    0.779 *** \n    1.012 *** \n    1.238 *** \n    0.819 *** \n    0.914 *** \n    1.090 *** \n  \n  \n     \n    (0.252) \n    (0.240) \n    (0.251) \n    (0.292) \n    (0.276) \n    (0.264) \n  \n  \n    Quadratic \n    -0.003 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 * \n    -0.004 ** \n    -0.005 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618352 \n    1638394 \n    2844558 \n    2844490 \n    2862651 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticViolent.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Change the names of the types of crime ####\ntab = mutate(tab, dependent = mgsub(dependent, c(\"NonViolent\"), c(\"Non Violent\")))\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\nviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(violent) = c(\"names\", \"\", \" \", \"N.obs\", \"R2\", \"BIC\") \nviolent = select(violent, -V1); colnames(violent) = violent[1,]; violent = violent[-1, ]\n# Create the data-frame for the html table\nnonviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Non Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(nonviolent) = c(\"names\", \"  \", \"   \", \"N.obs \", \"R2 \", \"BIC \") \nnonviolent = select(nonviolent, -V1); colnames(nonviolent) = nonviolent[1,]; nonviolent = nonviolent[-1, ]\n#\nhtml = rbind(violent ,nonviolent)\n# change the column names \ncolnames(html) = paste0(\"(\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2), \")\")\n# Create the HTML table of the first figure\nkbl(html, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n   pack_rows(\"Violent\", 1, 5) %>%\n  pack_rows(\"Non Violent\", 6, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 3:  Estimates on the effects of air pollution for violent and non-violent crimes \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n    (Linear) \n    (Linear) \n    (Quadratic) \n    (Linear) \n    (Linear) \n    (Quadratic) \n  \n \n\n  Violent\n\n     \n    0.240 * \n    1.556 *** \n    -0.006 *** \n    0.797 *** \n    1.314 ** \n    -0.004 \n  \n  \n     \n    (0.130) \n    (0.304) \n    (0.001) \n    (0.168) \n    (0.517) \n    (0.004) \n  \n  \n    N.obs \n    0.130 \n    0.130 \n    0.130 \n    0.125 \n    0.125 \n    0.125 \n  \n  \n    R2 \n    1322488 \n    1322488 \n    1322488 \n    1244562 \n    1244562 \n    1244562 \n  \n  \n    BIC \n    870538 \n    870529 \n    870529 \n    1085029 \n    1085040 \n    1085040 \n  \n  Non Violent\n\n     \n    0.197 \n    0.704 * \n    -0.002 * \n    0.317 *** \n    0.546 * \n    -0.002 \n  \n  \n     \n    (0.172) \n    (0.407) \n    (0.001) \n    (0.097) \n    (0.291) \n    (0.002) \n  \n  \n    N.obs \n    0.219 \n    0.219 \n    0.219 \n    0.189 \n    0.189 \n    0.189 \n  \n  \n    R2 \n    1300287 \n    1300287 \n    1300287 \n    1271109 \n    1271109 \n    1271109 \n  \n  \n    BIC \n    777428 \n    777439 \n    777439 \n    1597431 \n    1597444 \n    1597444 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticOtherCrimes.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2))\ntab = tab[-1,]\ntab = tab[-c(16,17,18),]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 2, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 4:  Estimates on the effects of air pollution across different crime categories \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n     \n    Linear \n    Linear \n    Quadratic \n    Linear \n    Linear \n    Quadratic \n  \n \n\n  \n    2 \n    Burglary \n    0.340 \n    0.214 \n    0.001 \n    0.169 \n    -0.256 \n    0.004 \n  \n  \n    3 \n     \n    (0.304) \n    (0.871) \n    (0.004) \n    (0.186) \n    (0.571) \n    (0.004) \n  \n  \n    4 \n    Homicide \n    0.521 \n    4.562 ** \n    -0.019 *** \n    0.084 \n    -9.775 \n    0.089 \n  \n  \n    5 \n     \n    (0.850) \n    (1.824) \n    (0.007) \n    (12.396) \n    (25.925) \n    (0.132) \n  \n  \n    6 \n    Robbery \n    0.238 * \n    1.437 *** \n    -0.005 *** \n    0.395 \n    1.614 * \n    -0.010 \n  \n  \n    7 \n     \n    (0.137) \n    (0.346) \n    (0.002) \n    (0.281) \n    (0.887) \n    (0.007) \n  \n  \n    8 \n    Larceny \n    -0.018 \n    0.256 \n    -0.001 \n    0.293 ** \n    0.529 * \n    -0.002 \n  \n  \n    9 \n     \n    (0.124) \n    (0.492) \n    (0.002) \n    (0.126) \n    (0.319) \n    (0.002) \n  \n  \n    10 \n    SexCrime \n    0.497 \n    3.099 ** \n    -0.012 * \n    0.411 *** \n    0.866 *** \n    -0.004 * \n  \n  \n    11 \n     \n    (0.374) \n    (1.534) \n    (0.006) \n    (0.148) \n    (0.299) \n    (0.002) \n  \n  \n    12 \n    fraud \n    0.336 \n    1.580 * \n    -0.005 * \n    0.339 \n    0.586 \n    -0.002 \n  \n  \n    13 \n     \n    (0.243) \n    (0.917) \n    (0.003) \n    (0.318) \n    (1.173) \n    (0.009) \n  \n  \n    14 \n    other \n    0.633 *** \n    1.289 *** \n    -0.003 ** \n    0.402 ** \n    1.287 ** \n    -0.007 ** \n  \n  \n    15 \n     \n    (0.128) \n    (0.368) \n    (0.001) \n    (0.183) \n    (0.521) \n    (0.004) \n  \n  \n    16 \n    R.Squared \n    0.147 \n    0.147 \n    0.147 \n    0.167 \n    0.167 \n    0.167 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\n\nRobustness section\nTable 5 contains the main results of the IV strategy\n\nTable 6Table 7Table 8Table 9\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(read_rds(paste0(file, \"/02_GenData/04_results/99_iv/LinearWdr8.rds\")),\n          read_rds(paste0(file, \"/02_GenData/04_results/99_iv/QuadWdr8.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\") %>%\n  mutate(var = ifelse(grepl(\"2\", var), \"Quadratic\", \"Linear\"))\n#### Take the exponent of the point estimates ####\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Split the data set by the distinct specifications ####\ntab = mutate(tab, city = paste(model, city, var))\ntab = split(tab, f = tab$city)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = y),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\",\"Linear\", \"Linear \", \"Linear  \", \"Quadratic\", \" Linear\", \"Quadratic \")\nrownames(tab) = c(\"   \",\"\", \" \", \"R.Squared\", \"N.Obs\", \"BIC\"); tab = tab[-1,-1]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 1, \"New York\" = 1, \"Mexico City\" = 2, \"New York\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 2, \"Quadratic Model\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 5:  Effects of air pollution on criminality (IV) \n \n\n\nLinear Model\nQuadratic Model\n\n\n\nMexico City\nNew York\nMexico City\nNew York\n\n  \n      \n    Linear \n    Linear  \n    Linear   \n    Quadratic \n     Linear \n    Quadratic  \n  \n \n\n  \n     \n    0.327 \n    1.038 *** \n    2.139 *** \n    -0.006 ** \n    1.542 ** \n    -0.004 \n  \n  \n     \n    (0.309) \n    (0.186) \n    (0.584) \n    (0.002) \n    (0.612) \n    (0.006) \n  \n  Fitted-Statistics\n\n    R.Squared \n    0.224 \n    0.227 \n    0.224 \n    0.224 \n    0.227 \n    0.227 \n  \n  \n    N.Obs \n    1322972 \n    1272400 \n    1322972 \n    1322972 \n    1272400 \n    1272400 \n  \n  \n    BIC \n    1635929 \n    2858301 \n    1635938 \n    1635938 \n    2858315 \n    2858315 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeEst.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate(est = ifelse(grepl(\"nb|log\", spec) == F, est*25, (exp(est)-1)*1000))\ntab = tab %>% mutate(se = ifelse(grepl(\"nb|log\", spec) == F, se*25, (exp(se)-1)*1000))\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"OLS\", \"Log-Linear OLS \", \"Negative Binomial\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 6:  Effects of air pollution on criminality across different estimators \n \n\n\nMexico City\nNew York\n\n  \n     \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n  \n \n\n  Linear Model\n\n    Linear \n    0.005 ** \n    0.088 *** \n    0.329 *** \n    0.009 ** \n    0.157 *** \n    0.502 *** \n  \n  \n     \n    (0.002) \n    (0.026) \n    (0.115) \n    (0.004) \n    (0.055) \n    (0.069) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784659 \n    797576 \n    1634911 \n    3869900 \n    1612538 \n    2847884 \n  \n  Quadratic Model\n\n    Linear \n    0.007 * \n    0.141 * \n    1.256 *** \n    0.027 *** \n    0.481 *** \n    1.128 *** \n  \n  \n     \n    (0.004) \n    (0.070) \n    (0.205) \n    (0.009) \n    (0.131) \n    (0.197) \n  \n  \n    Quadratic \n    -0.000 \n    -0.000 \n    -0.004 *** \n    -0.000 ** \n    -0.003 *** \n    -0.005 *** \n  \n  \n     \n    (0.000) \n    (0.000) \n    (0.001) \n    (0.000) \n    (0.001) \n    (0.001) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784671 \n    797587 \n    1634895 \n    3869892 \n    1612524 \n    2847882 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/RobustSpecs.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"(1)\", \"(2) \", \"(3)\", \"(4)\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 7:  Robustness exercises on the effects of air pollution on criminality \n \n\n\nMexico City\nNew York\n\n  \n     \n    (1) \n    (2)  \n    (3) \n    (4) \n    (1) \n    (2)  \n    (3) \n    (4) \n  \n \n\n  Linear Model\n\n    Linear \n    0.262 *** \n    0.228 ** \n    0.228 ** \n    0.084 \n    0.459 *** \n    0.598 *** \n    0.584 *** \n    0.723 *** \n  \n  \n     \n    (0.100) \n    (0.109) \n    (0.109) \n    (0.214) \n    (0.072) \n    (0.086) \n    (0.087) \n    (0.161) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516118 \n    717986 \n    717986 \n    254487 \n    2728597 \n    2098240 \n    1879357 \n    994447 \n  \n  Quadratic Model\n\n    Linear \n    1.248 *** \n    1.595 *** \n    1.595 *** \n    1.356 ** \n    1.079 *** \n    1.335 *** \n    1.423 *** \n    1.331 ** \n  \n  \n     \n    (0.226) \n    (0.290) \n    (0.290) \n    (0.647) \n    (0.196) \n    (0.327) \n    (0.323) \n    (0.602) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.006 *** \n    -0.006 *** \n    -0.006 ** \n    -0.005 *** \n    -0.006 *** \n    -0.007 *** \n    -0.005 \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.003) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.004) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516098 \n    717980 \n    717980 \n    254497 \n    2728593 \n    2098239 \n    1879356 \n    994459 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(`Linear Model` = read_rds(paste0(file, \"02_GenData/04_results/LinearDynamic.rds\")),\n          `Quadratic Model` = read_rds(paste0(file, \"02_GenData/04_results/QuadraticDynamic.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\")\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", model)) %>% \n  mutate(col = paste(sample, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", model)) %>% \n  mutate(col = paste(sample, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"Lag 1\", \"Lag 4\", \"Lag 8\", \"Lag 16\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 8:  Effects of air pollution on criminality for different lag models \n \n\n\nMexico City\nNew York\n\n  \n     \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n  \n \n\n  Linear Model\n\n    Linear \n    0.188 \n    0.193 * \n    0.114 \n    0.099 \n    0.558 *** \n    0.612 *** \n    0.728 *** \n    0.658 *** \n  \n  \n     \n    (0.143) \n    (0.110) \n    (0.083) \n    (0.083) \n    (0.095) \n    (0.100) \n    (0.113) \n    (0.126) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0.220 \n    0.220 \n    0.220 \n    0.220 \n    0.224 \n    0.224 \n    0.224 \n    0.224 \n  \n  Quadratic Model\n\n    Linear \n    1.173 *** \n    0.930 *** \n    0.908 *** \n    0.927 *** \n    1.352 *** \n    1.542 *** \n    1.546 *** \n    1.501 *** \n  \n  \n     \n    (0.307) \n    (0.291) \n    (0.304) \n    (0.315) \n    (0.264) \n    (0.273) \n    (0.294) \n    (0.344) \n  \n  \n    Quadratic \n    -0.005 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 *** \n    -0.007 *** \n    -0.008 *** \n    -0.007 *** \n    -0.007 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n    (0.003) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level."
  },
  {
    "objectID": "01_about.html",
    "href": "01_about.html",
    "title": "The Nonlinear Relationship Between Pollution and Crime",
    "section": "",
    "text": "This research report contains three primary sections to accompany the study on the relationship between air pollution exposure and criminal behaviour in Mexico City and New York.\n\nIntroduction – Contains the instructions to replicate the data-sets and results of the study\nData Sets – Includes a description of all the data files we use throughout the study. It is divided into five sub-sections\n\n\n\nCrime data\nAir pollution data\nInverse distance weighting\nThe Now-Cast AQI\nRegression Data\n\n\n\nStudy Exhibits – Includes the R code and data necessary to replicate all the figures and tables in the study"
  },
  {
    "objectID": "01_about.html#replication",
    "href": "01_about.html#replication",
    "title": "The Nonlinear Relationship Between Pollution and Crime",
    "section": "Replication",
    "text": "Replication\nAll the raw files needed to run the code are in the dropbox repository\nIf you want to replicate the study:\nDownload all files in the dropbox repository while considering the space constraints in your computer.1\nThe files in the repository have a folder-like structure with the following key sections:\n\n01_RawData – Includes the raw data files divided into four main folders\n\n01_crimes - It is the repository with all the raw data on criminality for Mexico City and New York. It contains two sub-directories. 01_nyc has all the crime data of New York City (in CSV and Excel formats) and 03_cdmx has the analogous data from Mexico divided into two different CSV files (one between 2012 and 2015 and the other between 2016 and 2019).\n02_pollution - Repository with all the air pollution data for New York and Mexico City. It contains two sub-directories. 01_epa contains the air pollution data from the network of monitoring stations maintained by the US Environmental Protection Agency. This folder contains two additional folders, 02_daily contains zipped daily measurement files for each air pollutant and year between 2000 and 2019 for the entire USA and 02_StateData has a zipped file of hourly air pollution for each US state. Next, 03_cdmx contains the air pollution data for Mexico City across three repositories; 01_pol has a set of csv files with hourly air pollution data. 02_weather has a similar structure for weather controls. And 03_other contains a folder with the geographical location of measuring staions\n03_shapefiles – Folder with all the shape (spatial) files I use throughout the study. One for the boroughs in New York City and another one for the Mexican States\n04_weather - Folder with the weather data for New York City\n\n02_GenData – Contains the set of data.frames I use for the estimation of point estimates. Each data comes from the scientific manipulation of the raw files in the 01_RawFiles repository.\n\n01_crime: the folder contains three main files:\n\nCrimesCdmx.rds: Crime data for Mexico City\nCrimesNYC.rds: Crime data for New York City\ncrimes.rds: Crime data for Mexico City and New York\n\n02_pol: The folder contain N main files\n\nPolCdmx.rds: Air pollution data for Mexico City\nPolWeatherCdmx.rds: Air pollution and weather data for Mexico City\npolNYC.rds: Hourly pollution data for New York City\nRawWeatherNYC.rds: Hourly weather data for New York City\nPolWeatherNYC.rds: Air pollution and weather data for New York City\nRawPol.rds: Air pollution and weather data for Mexico City and New York\nIdwPol.rds: Inverse distance weighted pollution data for both cities\nPolReg.rds: Final data frame with hourly air pollution, weather, and AQI values\n\n03_RegData: Contains the files I use in the econometric analysis\n\nDataReg: It is the main file I use for the empirical analysis\nDataRobustness: Additional data for robustness exercises\n\n04_results: Contains all the results from the econometric specifications. Each result comes from the file 03_scripts/04_reg\n\n03_scripts – Here, I include all the R-scripts I use to transform the raw data into a useful format, perform descriptive statistics, and run my empirical specifications. I divide the scripts into tasks, particularly:\n\n01_crimes – It transforms and cleans the raw crime data into the format necessary to use in the empirical design\n02_pol – It transforms and cleans the air pollution and weather variables I use throughout the analysis\n03_RegData – It merges the crime and air pollution data according to the specifications of the stury\n04_reg - Contains all the econometric analysis\n05_tab - Generates (one by one) all of the tables in the study\n06_plot - Generates (one by one) all of the figures in the study\n99_robustness – Includes all robustness exercises I include in the study"
  },
  {
    "objectID": "02_exhibits.html#section",
    "href": "02_exhibits.html#section",
    "title": "Study Exhibits",
    "section": "",
    "text": "Results section\nTable 1 contains the coefficients on the linear effect of the Now Cast AQI on crime counts in New York and Mexico City. Table 2 contains the coefficients of the quadratic model estimating the relationship between pollution and criminality in Mexico city and New York. Table 3 contains the coefficients of the linear and quadratic models on the relationship between pollution and criminality for violent and nonviolent crimes in Mexico city and New York. Table 4 contains the estimates on the effects across all crime categories.\n\nTable 2Table 3Table 4Table 5\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"/02_GenData/04_results/PoissonLinear.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Estimate\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\", general_title = \"Notes:\", footnote_as_chunk = T)\n\n\n\n\nTable 1:  Effect of pollution on criminality (linear model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Estimate \n    0.197 * \n    0.272 ** \n    0.327 ** \n    0.363 *** \n    0.420 *** \n    0.477 *** \n  \n  \n     \n    (0.111) \n    (0.117) \n    (0.131) \n    (0.109) \n    (0.102) \n    (0.102) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618359 \n    1638412 \n    2844555 \n    2844488 \n    2862656 \n  \n\n\nNotes:  $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadratic.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r, x$N, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(tab) = c(\"names\", \"Linear\", \" \", \"Quadratic\", \"\", \"N.obs\", \"R2\", \"BIC\") \ntab = select(tab, -V1); colnames(tab) = tab[1,]; tab = tab[-1, ]\n# change the column names \ncolnames(tab) = paste0(\"(\", rep(seq(1,3,1),2), \")\")\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  pack_rows(\"Fitted-Statistics\", 5, 7) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T)\n\n\n\n\nTable 2:  Effect of pollution on criminality (quadratic model) \n \n\n\nMexicoCity\nNew York\n\n  \n      \n    (1) \n    (2) \n    (3) \n    (1) \n    (2) \n    (3) \n  \n \n\n  \n    Linear \n    0.779 *** \n    1.012 *** \n    1.238 *** \n    0.819 *** \n    0.914 *** \n    1.090 *** \n  \n  \n     \n    (0.252) \n    (0.240) \n    (0.251) \n    (0.292) \n    (0.276) \n    (0.264) \n  \n  \n    Quadratic \n    -0.003 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 * \n    -0.004 ** \n    -0.005 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n  \n  Fitted-Statistics\n\n    N.obs \n    0.244 \n    0.245 \n    0.220 \n    0.223 \n    0.224 \n    0.224 \n  \n  \n    R2 \n    1433832 \n    1433832 \n    1433832 \n    1510319 \n    1510319 \n    1510319 \n  \n  \n    BIC \n    1618353 \n    1618352 \n    1638394 \n    2844558 \n    2844490 \n    2862651 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticViolent.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Change the names of the types of crime ####\ntab = mutate(tab, dependent = mgsub(dependent, c(\"NonViolent\"), c(\"Non Violent\")))\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\nviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(violent) = c(\"names\", \"\", \" \", \"N.obs\", \"R2\", \"BIC\") \nviolent = select(violent, -V1); colnames(violent) = violent[1,]; violent = violent[-1, ]\n# Create the data-frame for the html table\nnonviolent = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\", dependent == \"Non Violent\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Style the data frame \nrownames(nonviolent) = c(\"names\", \"  \", \"   \", \"N.obs \", \"R2 \", \"BIC \") \nnonviolent = select(nonviolent, -V1); colnames(nonviolent) = nonviolent[1,]; nonviolent = nonviolent[-1, ]\n#\nhtml = rbind(violent ,nonviolent)\n# change the column names \ncolnames(html) = paste0(\"(\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2), \")\")\n# Create the HTML table of the first figure\nkbl(html, align = \"c\")  %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14, full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n   pack_rows(\"Violent\", 1, 5) %>%\n  pack_rows(\"Non Violent\", 6, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 3:  Estimates on the effects of air pollution for violent and non-violent crimes \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n    (Linear) \n    (Linear) \n    (Quadratic) \n    (Linear) \n    (Linear) \n    (Quadratic) \n  \n \n\n  Violent\n\n     \n    0.240 * \n    1.556 *** \n    -0.006 *** \n    0.797 *** \n    1.314 ** \n    -0.004 \n  \n  \n     \n    (0.130) \n    (0.304) \n    (0.001) \n    (0.168) \n    (0.517) \n    (0.004) \n  \n  \n    N.obs \n    0.130 \n    0.130 \n    0.130 \n    0.125 \n    0.125 \n    0.125 \n  \n  \n    R2 \n    1322488 \n    1322488 \n    1322488 \n    1244562 \n    1244562 \n    1244562 \n  \n  \n    BIC \n    870538 \n    870529 \n    870529 \n    1085029 \n    1085040 \n    1085040 \n  \n  Non Violent\n\n     \n    0.197 \n    0.704 * \n    -0.002 * \n    0.317 *** \n    0.546 * \n    -0.002 \n  \n  \n     \n    (0.172) \n    (0.407) \n    (0.001) \n    (0.097) \n    (0.291) \n    (0.002) \n  \n  \n    N.obs \n    0.219 \n    0.219 \n    0.219 \n    0.189 \n    0.189 \n    0.189 \n  \n  \n    R2 \n    1300287 \n    1300287 \n    1300287 \n    1271109 \n    1271109 \n    1271109 \n  \n  \n    BIC \n    777428 \n    777439 \n    777439 \n    1597431 \n    1597444 \n    1597444 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/PoissonQuadraticOtherCrimes.rds\"))\n# Take the exponent of point estimates\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Paste the city and the specification \ntab = mutate(tab, specification = paste(city, specification, estimate, sep = \"-\"))\n# Split the data set by the distinct specifications \ntab = split(tab, f = tab$specification)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = dplyr::filter(y, var == \"NowCast\")),function(x) \n    createTexreg(x$dependent, x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\", rep(c(\"Linear\", \"Linear\", \"Quadratic\"),2))\ntab = tab[-1,]\ntab = tab[-c(16,17,18),]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2, \"Linear Model\" = 1, \"Quadratic Model\" = 2)) %>%\n  add_header_above(c(\" \" = 2, \"MexicoCity\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 4:  Estimates on the effects of air pollution across different crime categories \n \n\n\nMexicoCity\nNew York\n\n\n\nLinear Model\nQuadratic Model\nLinear Model\nQuadratic Model\n\n  \n      \n     \n    Linear \n    Linear \n    Quadratic \n    Linear \n    Linear \n    Quadratic \n  \n \n\n  \n    2 \n    Burglary \n    0.340 \n    0.214 \n    0.001 \n    0.169 \n    -0.256 \n    0.004 \n  \n  \n    3 \n     \n    (0.304) \n    (0.871) \n    (0.004) \n    (0.186) \n    (0.571) \n    (0.004) \n  \n  \n    4 \n    Homicide \n    0.521 \n    4.562 ** \n    -0.019 *** \n    0.084 \n    -9.775 \n    0.089 \n  \n  \n    5 \n     \n    (0.850) \n    (1.824) \n    (0.007) \n    (12.396) \n    (25.925) \n    (0.132) \n  \n  \n    6 \n    Robbery \n    0.238 * \n    1.437 *** \n    -0.005 *** \n    0.395 \n    1.614 * \n    -0.010 \n  \n  \n    7 \n     \n    (0.137) \n    (0.346) \n    (0.002) \n    (0.281) \n    (0.887) \n    (0.007) \n  \n  \n    8 \n    Larceny \n    -0.018 \n    0.256 \n    -0.001 \n    0.293 ** \n    0.529 * \n    -0.002 \n  \n  \n    9 \n     \n    (0.124) \n    (0.492) \n    (0.002) \n    (0.126) \n    (0.319) \n    (0.002) \n  \n  \n    10 \n    SexCrime \n    0.497 \n    3.099 ** \n    -0.012 * \n    0.411 *** \n    0.866 *** \n    -0.004 * \n  \n  \n    11 \n     \n    (0.374) \n    (1.534) \n    (0.006) \n    (0.148) \n    (0.299) \n    (0.002) \n  \n  \n    12 \n    fraud \n    0.336 \n    1.580 * \n    -0.005 * \n    0.339 \n    0.586 \n    -0.002 \n  \n  \n    13 \n     \n    (0.243) \n    (0.917) \n    (0.003) \n    (0.318) \n    (1.173) \n    (0.009) \n  \n  \n    14 \n    other \n    0.633 *** \n    1.289 *** \n    -0.003 ** \n    0.402 ** \n    1.287 ** \n    -0.007 ** \n  \n  \n    15 \n     \n    (0.128) \n    (0.368) \n    (0.001) \n    (0.183) \n    (0.521) \n    (0.004) \n  \n  \n    16 \n    R.Squared \n    0.147 \n    0.147 \n    0.147 \n    0.167 \n    0.167 \n    0.167 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\n\nRobustness section\nTable 5 contains the main results of the IV strategy\n\nTable 6Table 7Table 8Table 9\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(read_rds(paste0(file, \"/02_GenData/04_results/99_iv/LinearWdr8.rds\")),\n          read_rds(paste0(file, \"/02_GenData/04_results/99_iv/QuadWdr8.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\") %>%\n  mutate(var = ifelse(grepl(\"2\", var), \"Quadratic\", \"Linear\"))\n#### Take the exponent of the point estimates ####\ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n#### Split the data set by the distinct specifications ####\ntab = mutate(tab, city = paste(model, city, var))\ntab = split(tab, f = tab$city)\n# Create the data-frame for the html table\ntab = matrixreg(lapply(lapply(tab, function(y) \n  y = y),function(x) \n    createTexreg(\"\", x$est,x$se, x$p,\n                 gof.names = c(rep(\"R.Squared\", nrow(x)), rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$r2, x$n, x$BIC),gof.decimal = c(rep(T, nrow(x)), rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# change the column names \ncolnames(tab) = c(\"\",\"Linear\", \"Linear \", \"Linear  \", \"Quadratic\", \" Linear\", \"Quadratic \")\nrownames(tab) = c(\"   \",\"\", \" \", \"R.Squared\", \"N.Obs\", \"BIC\"); tab = tab[-1,-1]\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 1, \"New York\" = 1, \"Mexico City\" = 2, \"New York\" = 2)) %>%\n  add_header_above(c(\" \" = 1, \"Linear Model\" = 2, \"Quadratic Model\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   pack_rows(\"Fitted-Statistics\", 3, 5) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 5:  Effects of air pollution on criminality (IV) \n \n\n\nLinear Model\nQuadratic Model\n\n\n\nMexico City\nNew York\nMexico City\nNew York\n\n  \n      \n    Linear \n    Linear  \n    Linear   \n    Quadratic \n     Linear \n    Quadratic  \n  \n \n\n  \n     \n    0.327 \n    1.038 *** \n    2.139 *** \n    -0.006 ** \n    1.542 ** \n    -0.004 \n  \n  \n     \n    (0.309) \n    (0.186) \n    (0.584) \n    (0.002) \n    (0.612) \n    (0.006) \n  \n  Fitted-Statistics\n\n    R.Squared \n    0.224 \n    0.227 \n    0.224 \n    0.224 \n    0.227 \n    0.227 \n  \n  \n    N.Obs \n    1322972 \n    1272400 \n    1322972 \n    1322972 \n    1272400 \n    1272400 \n  \n  \n    BIC \n    1635929 \n    2858301 \n    1635938 \n    1635938 \n    2858315 \n    2858315 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/AlternativeEst.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate(est = ifelse(grepl(\"nb|log\", spec) == F, est*25, (exp(est)-1)*1000))\ntab = tab %>% mutate(se = ifelse(grepl(\"nb|log\", spec) == F, se*25, (exp(se)-1)*1000))\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(spec = mgsub(spec, c(\"ols\", \"log-ols\", \"nb\"), c(\"1\", \"2\", \"3\"))) %>%\n  mutate(col = paste(city, spec)) \n\nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"OLS\", \"Log-Linear OLS \", \"Negative Binomial\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 3, \"New York\" = 3)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 6:  Effects of air pollution on criminality across different estimators \n \n\n\nMexico City\nNew York\n\n  \n     \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n    OLS \n    Log-Linear OLS  \n    Negative Binomial \n  \n \n\n  Linear Model\n\n    Linear \n    0.005 ** \n    0.088 *** \n    0.329 *** \n    0.009 ** \n    0.157 *** \n    0.502 *** \n  \n  \n     \n    (0.002) \n    (0.026) \n    (0.115) \n    (0.004) \n    (0.055) \n    (0.069) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784659 \n    797576 \n    1634911 \n    3869900 \n    1612538 \n    2847884 \n  \n  Quadratic Model\n\n    Linear \n    0.007 * \n    0.141 * \n    1.256 *** \n    0.027 *** \n    0.481 *** \n    1.128 *** \n  \n  \n     \n    (0.004) \n    (0.070) \n    (0.205) \n    (0.009) \n    (0.131) \n    (0.197) \n  \n  \n    Quadratic \n    -0.000 \n    -0.000 \n    -0.004 *** \n    -0.000 ** \n    -0.003 *** \n    -0.005 *** \n  \n  \n     \n    (0.000) \n    (0.000) \n    (0.001) \n    (0.000) \n    (0.001) \n    (0.001) \n  \n  \n    N.Obs \n    1433822 \n    1433822 \n    1324983 \n    1272599 \n    1272599 \n    1272440 \n  \n  \n    BIC \n    2784671 \n    797587 \n    1634895 \n    3869892 \n    1612524 \n    2847882 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = read_rds(paste0(file, \"02_GenData/04_results/RobustSpecs.rds\"))\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nlinear = split(linear, f = linear$col)\n#\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", spec)) %>% \n  mutate(spec = gsub(\"Linear|Quadratic| \", \"\", spec)) %>%\n  mutate(col = paste(city, data)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$estimate, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) , rep(\"BIC\", nrow(x))),\n                 gof = c(x$n, x$BIC),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"(1)\", \"(2) \", \"(3)\", \"(4)\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 7:  Robustness exercises on the effects of air pollution on criminality \n \n\n\nMexico City\nNew York\n\n  \n     \n    (1) \n    (2)  \n    (3) \n    (4) \n    (1) \n    (2)  \n    (3) \n    (4) \n  \n \n\n  Linear Model\n\n    Linear \n    0.262 *** \n    0.228 ** \n    0.228 ** \n    0.084 \n    0.459 *** \n    0.598 *** \n    0.584 *** \n    0.723 *** \n  \n  \n     \n    (0.100) \n    (0.109) \n    (0.109) \n    (0.214) \n    (0.072) \n    (0.086) \n    (0.087) \n    (0.161) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516118 \n    717986 \n    717986 \n    254487 \n    2728597 \n    2098240 \n    1879357 \n    994447 \n  \n  Quadratic Model\n\n    Linear \n    1.248 *** \n    1.595 *** \n    1.595 *** \n    1.356 ** \n    1.079 *** \n    1.335 *** \n    1.423 *** \n    1.331 ** \n  \n  \n     \n    (0.226) \n    (0.290) \n    (0.290) \n    (0.647) \n    (0.196) \n    (0.327) \n    (0.323) \n    (0.602) \n  \n  \n    Quadratic \n    -0.004 *** \n    -0.006 *** \n    -0.006 *** \n    -0.006 ** \n    -0.005 *** \n    -0.006 *** \n    -0.007 *** \n    -0.005 \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.003) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.004) \n  \n  \n    N.Obs \n    1269775 \n    1184536 \n    1184536 \n    1082248 \n    1220013 \n    1256884 \n    1256884 \n    1213987 \n  \n  \n    BIC \n    1516098 \n    717980 \n    717980 \n    254497 \n    2728593 \n    2098239 \n    1879356 \n    994459 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\n\n\n\n\n\n\n\n\n\nShow the Code\n# Set the path \nfile = paste0(gsub(\"NonLinearCrime/\",\"\", getwd()), \"/ReplicationFolder/\")\n# Load the data\ntab = list(`Linear Model` = read_rds(paste0(file, \"02_GenData/04_results/LinearDynamic.rds\")),\n          `Quadratic Model` = read_rds(paste0(file, \"02_GenData/04_results/QuadraticDynamic.rds\")))\n#### Bind the estimates together ####\ntab = rbindlist(tab, idcol = \"model\")\n# Take the exponent of the point estimates \ntab = tab %>% mutate_at(vars(est, se), function(x) x = (exp(x) -1)*100*10)\n# Create the data frame of linear coefficients\nlinear = tab %>% dplyr::filter(grepl(\"Linear\", model)) %>% \n  mutate(col = paste(sample, spec)) \nlinear = split(linear, f = linear$col)\n# Create a data frame of the quadratic coefficients\nquadratic = tab %>% dplyr::filter(grepl(\"Quadratic\", model)) %>% \n  mutate(col = paste(sample, spec)) \nquadratic = split(quadratic, f = quadratic$col)\n# Create the data-frame for the html table\nquadratic = matrixreg(lapply(lapply(quadratic, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(F, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Transform the linear coefficients to a data frame\nlinear = matrixreg(lapply(lapply(linear, function(y) y = y),function(x) \n    createTexreg(x$type, x$est,x$se, x$p,\n                 gof.names = c( rep(\"N.Obs\", nrow(x)) ,rep(\"R.Squared\", nrow(x))),\n                 gof = c(x$nobs, x$r2),gof.decimal = c(rep(F, nrow(x)), rep(T, nrow(x))))),\n  booktabs = T, symbol = \"+\", digits = 3,stars = c(0.01, 0.05, 0.1)) %>% as.data.frame(.)\n# Take away bad rows\nquadratic = quadratic[-1,]; linear = linear[-1,]\n# Add linear and quadratic coefficients\ntab = rbindlist(list(linear, quadratic))\ncolnames(tab) = c(\"\", rep(c(\"Lag 1\", \"Lag 4\", \"Lag 8\", \"Lag 16\"),2))\n# Create the HTML table of the first figure\nkbl(tab, align = \"c\") %>%\n  kable_classic() %>%\n  kable_styling(font_size = 14) %>%\n  add_header_above(c(\" \" = 1, \"Mexico City\" = 4, \"New York\" = 4)) %>%\n  kable_styling(bootstrap_option = c(\"hover\")) %>%   \n  pack_rows(\"Linear Model\", 1, 4) %>%\n  pack_rows(\"Quadratic Model\", 5, 10) %>%\n  footnote(general = \"$^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.\", footnote_as_chunk = T) %>%  scroll_box(height = \"500px\") \n\n\n\n\nTable 8:  Effects of air pollution on criminality for different lag models \n \n\n\nMexico City\nNew York\n\n  \n     \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n    Lag 1 \n    Lag 4 \n    Lag 8 \n    Lag 16 \n  \n \n\n  Linear Model\n\n    Linear \n    0.188 \n    0.193 * \n    0.114 \n    0.099 \n    0.558 *** \n    0.612 *** \n    0.728 *** \n    0.658 *** \n  \n  \n     \n    (0.143) \n    (0.110) \n    (0.083) \n    (0.083) \n    (0.095) \n    (0.100) \n    (0.113) \n    (0.126) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0.220 \n    0.220 \n    0.220 \n    0.220 \n    0.224 \n    0.224 \n    0.224 \n    0.224 \n  \n  Quadratic Model\n\n    Linear \n    1.173 *** \n    0.930 *** \n    0.908 *** \n    0.927 *** \n    1.352 *** \n    1.542 *** \n    1.546 *** \n    1.501 *** \n  \n  \n     \n    (0.307) \n    (0.291) \n    (0.304) \n    (0.315) \n    (0.264) \n    (0.273) \n    (0.294) \n    (0.344) \n  \n  \n    Quadratic \n    -0.005 *** \n    -0.003 *** \n    -0.004 *** \n    -0.004 *** \n    -0.007 *** \n    -0.008 *** \n    -0.007 *** \n    -0.007 *** \n  \n  \n     \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.001) \n    (0.002) \n    (0.002) \n    (0.002) \n    (0.003) \n  \n  \n    N.Obs \n    1324973 \n    1324944 \n    1324910 \n    1324885 \n    1510106 \n    1510025 \n    1509917 \n    1509809 \n  \n  \n    R.Squared \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n    0 \n  \n\n\nNote:   $^{***}p<0.01$, $^{**}p<0.05$, $^*p<0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level."
  }
]