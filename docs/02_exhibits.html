<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Luis Sarmiento">

<title>The Nonlinear Relationship Between Pollution and Crime - Study Exhibits</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Nonlinear Relationship Between Pollution and Crime</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./01_about.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gsaabogado"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/gsaabogado"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://luissarmiento.net/">Personal Site</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Study Exhibits</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Sections</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_DataFiles.html" class="sidebar-item-text sidebar-link">Data Sets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_exhibits.html" class="sidebar-item-text sidebar-link active">Study Exhibits</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#theoretical-background" id="toc-theoretical-background" class="nav-link active" data-scroll-target="#theoretical-background">Theoretical Background</a></li>
  <li><a href="#descriptive-statistics-data-section" id="toc-descriptive-statistics-data-section" class="nav-link" data-scroll-target="#descriptive-statistics-data-section">Descriptive Statistics (Data section)</a></li>
  <li><a href="#results-section" id="toc-results-section" class="nav-link" data-scroll-target="#results-section">Results section</a></li>
  <li><a href="#robustness-section" id="toc-robustness-section" class="nav-link" data-scroll-target="#robustness-section">Robustness section</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Study Exhibits</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Luis Sarmiento </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">

</div>
<p>In this section, I present all the exhibits in the study: <em>The nonlinear effects of pollution on crime: Evidence from Mexico City and New York</em> – Forthcoming in <em>Environmental Research - Health</em></p>
<p>I structure the section in four different subsections:</p>
<ul>
<li>Theoretical Background</li>
<li>Data</li>
<li>Results</li>
<li>Robustness</li>
<li>Appendix</li>
</ul>
<p>These subsections are in line with the study’s structure. For each subsection, there is a panel-tabset of figures and tables part of the corresponding section in the printer article. Each tab contains the table and figure number that corresponds to the original study.</p>
<section id="theoretical-background" class="level1">
<h1>Theoretical Background</h1>
<p>In the theoretical section of the study, I present a slight theoretical introduction to the relationship between air pollution and crime while building support for the hypothesis that air pollution has a non-linear effect on criminality. This section consist of four figures</p>
<ul>
<li>Figure 1: <em>Probability mass function for different Poisson distributions</em>. The figure presents the probability mass function of this study’s primary data set on the number of hourly crimes occurring in the vicinity of pollution measuring stations in Mexico City and New York alongside four simulated Poisson distributions with variances equal to 0.25, 0.5, 0.75, and 1.0</li>
<li>Figure 2 (a): <em>Relationship of the matching function with the number of victims and criminals.</em> The figure shows the proposed theoretical relation between the match of victims and criminals in the market and the number of agents.</li>
<li>Figure 2 (b): <em>Relationship between exposure to air pollution and the number of victims and criminals.</em> The figure shows the theoretical relationship between the number of agents in the market and air pollution.</li>
<li>Figure 3: <em>Theoretical relationship between air pollution and crime; the red line marks the level of air pollution that maximizes criminality, i.e., <span class="math inline">\(\frac{\partial crime}{\partial pollution} = 0\)</span>.</em></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Figure 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Figure 2(a)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Figure 2(b)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Figure 3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/03_RegData/DataReg.rds"</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the different Poisson distributions</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">0.25</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> stats<span class="sc">::</span><span class="fu">rpois</span>(<span class="dv">3000000</span>, <span class="fl">0.25</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">count =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">0.5</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> stats<span class="sc">::</span><span class="fu">rpois</span>(<span class="dv">3000000</span>, <span class="fl">0.5</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">count =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)), </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">0.75</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> stats<span class="sc">::</span><span class="fu">rpois</span>(<span class="dv">3000000</span>, <span class="fl">0.75</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">count =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)), </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">1.0</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> stats<span class="sc">::</span><span class="fu">rpois</span>(<span class="dv">3000000</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">count =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)), </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Real Sample</span><span class="st">`</span> <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="at">value =</span> total) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">count =</span> count<span class="sc">/</span><span class="fu">sum</span>(count))) <span class="sc">%&gt;%</span> <span class="fu">rbindlist</span>(., <span class="at">idcol =</span> <span class="st">"Lambda"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the empirical data and the different poisson distributions</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(plot, value <span class="sc">&lt;</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> count, <span class="at">color =</span> Lambda)) <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> count, <span class="at">color =</span> Lambda)) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(), <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.7</span>))  <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"k"</span>, <span class="at">y =</span> <span class="st">"P(Crimes = k)"</span>) <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray40"</span>, <span class="st">"gray60"</span>, <span class="st">"gray80"</span>, <span class="st">"orange"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure1-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 1: Probability mass function for different Poisson distributions</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><em>Notes:</em> This figure presents the probability mass function of this study’s primary data set on the number of hourly crimes occurring in the vicinity of pollution measuring stations in Mexico City and New York alongside four simulated Poisson distributions with variances equal to 0.25, 0.5, 0.75, and 1.0</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the dummy data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">temp =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">2</span>), <span class="at">s =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>), <span class="at">p =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">s_1 =</span> s<span class="sc">*</span>p) <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">s_1 =</span> ((s_1 <span class="sc">-</span> <span class="fu">min</span>(s_1))<span class="sc">/</span>(<span class="fu">max</span>(s_1)<span class="sc">-</span> <span class="fu">min</span>(s_1)))) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(temp <span class="sc">&lt;=</span> <span class="dv">20</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the function</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> s_1)) <span class="sc">+</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> s_1)) <span class="sc">+</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">axis.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"V(t), C(t)"</span>, <span class="at">y=</span> <span class="st">"m[V(t), C(t)]"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure2a" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure2a-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 2: Relationship of the matching function with the number of victims and criminals</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the simulated data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">temp =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">2</span>), <span class="at">s =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>), <span class="at">p =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">s_1 =</span> s<span class="sc">*</span>p<span class="sc">*-</span><span class="dv">1</span>) <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">s_1 =</span> ((s_1 <span class="sc">-</span> <span class="fu">min</span>(s_1))<span class="sc">/</span>(<span class="fu">max</span>(s_1)<span class="sc">-</span> <span class="fu">min</span>(s_1)))) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(temp <span class="sc">&lt;=</span> <span class="dv">20</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the function</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> s_1)) <span class="sc">+</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> s_1)) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">axis.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"V(t), C(t)"</span>, <span class="at">x=</span> <span class="st">"Exposure to air Pollution"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure2b" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure2b-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 3: Relationship between exposure to air pollution and the number of victims and criminals</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div id="fig-figure2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/FunctionC.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4: Theoretical relationship between air pollution and crime; the red line marks the level of air pollution that maximizes criminality, i.e., <span class="math inline">\(\frac{\partial crime}{\partial pollution} = 0\)</span>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="descriptive-statistics-data-section" class="level1">
<h1>Descriptive Statistics (Data section)</h1>
<p>This section corresponds to the <em>Data</em> section of the study. It contains a set of descriptive statistics and data documentation through two figures and one table.</p>
<ul>
<li>Figure 4: The grid shows the <em>temporal behavior of criminality in Mexico City and New York.</em> Clockwise it shows the hourly, monthly, and yearly variation concerning the average.</li>
<li>Figure 5: <em>Location of pollution measuring stations in Mexico City and New York.</em></li>
<li>Table 1: <em>Descriptive statistics on the number of hourly crimes happening in a two-kilometer radius around pollution measuring stations in Mexico City and New York.</em></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Figure 4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Figure 5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Table 1</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/03_RegData/DataReg.rds"</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to the hourly level</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>hr <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(hour), city) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(total)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">avg =</span> <span class="fu">mean</span>(count, <span class="at">na.rm =</span> T))<span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dev =</span> ((count<span class="sc">-</span>avg)<span class="sc">/</span>avg)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Hourly Variation"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to the monthly leve</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>mo <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(month), city) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(total))  <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">avg =</span> <span class="fu">mean</span>(count, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dev =</span> ((count<span class="sc">-</span>avg)<span class="sc">/</span>avg)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Monthly Variation"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to the yearly leve</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ye <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(year), city) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(total))  <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">avg =</span> <span class="fu">mean</span>(count, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dev =</span> ((count<span class="sc">-</span>avg)<span class="sc">/</span>avg)<span class="sc">*</span><span class="dv">100</span>)<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Yearly Variation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">!=</span> <span class="dv">2006</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Rbindlist all data sets</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>temporal <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(hr, mo, ye)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of the city</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>temporal <span class="ot">=</span> <span class="fu">mutate</span>(temporal, <span class="at">city =</span> <span class="fu">ifelse</span>(city <span class="sc">==</span> <span class="st">"nyc"</span>, <span class="st">"New York City"</span>, <span class="st">"Mexico City"</span>))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the deviation from the average</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(temporal) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> dev, <span class="at">color =</span> city, <span class="at">group =</span> city)) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> dev, <span class="at">color =</span> city, <span class="at">group =</span> city)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),)  <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"% Deviation from the mean"</span>)  <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"darkorange"</span>)) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 5: The grid shows the temporal behavior of criminality in Mexico City and New York. Clockwise it shows the hourly, monthly, and yearly variation concerning the average.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### Load the spatial data</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>nyc <span class="ot">=</span> <span class="fu">read_sf</span>(<span class="fu">paste0</span>(file, <span class="st">"01_RawData/03_shapefiles/NYC Buroughs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="st">"New York"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(city) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>cdmx <span class="ot">=</span> <span class="fu">read_sf</span>(<span class="fu">paste0</span>(file, <span class="st">"01_RawData/03_shapefiles/States in Mexico"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ENTIDAD <span class="sc">==</span> <span class="st">"DISTRITO FEDERAL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="st">"Mexico City"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(city) <span class="sc">%&gt;%</span> <span class="fu">st_cast</span>(., <span class="st">"MULTIPOLYGON"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude stations with no crimes during the entire period</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(station) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">sum</span>(total) <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>PolSt <span class="ot">=</span> <span class="fu">select</span>(data, station, lon, lat) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data set of stations for Mexico City</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>stcdmx <span class="ot">=</span> <span class="fu">select</span>(data, station, lon, lat, city) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()<span class="sc">%&gt;%</span> <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"cdmx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(., <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(nyc)) </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data set of stations</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>stnyc <span class="ot">=</span> <span class="fu">select</span>(data, station, lon, lat, city) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()<span class="sc">%&gt;%</span> <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"nyc"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(., <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(nyc)) </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the stations into a spatial set</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>PolSt <span class="ot">=</span>  <span class="fu">st_as_sf</span>(PolSt, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the shapefiles of ploygons and stations in both cities</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">st_transform</span>(nyc, <span class="at">crs =</span> <span class="dv">4326</span>), <span class="fu">st_transform</span>(cdmx, <span class="at">crs =</span> <span class="dv">4326</span>))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>st <span class="ot">=</span> <span class="fu">rbind</span>(stcdmx, stnyc)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the stations over Spain and Madrid</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_style</span>(<span class="st">"classic"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>tmap <span class="ot">=</span> <span class="fu">tm_graticules</span>(<span class="at">labels.cardinal =</span> F, <span class="at">alpha =</span> <span class="fl">0.5</span>, , <span class="at">labels.size =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(shp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"city"</span>) <span class="sc">+</span> <span class="fu">tm_shape</span>(st) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span> <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type =</span> <span class="st">"rose"</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"top"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.20</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>), <span class="at">text.size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> F, <span class="at">legend.stack =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"top"</span>), </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">inner.margins =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>)); tmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 6: Location of pollution measuring stations in Mexico City and New York</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/03_RegData/DataReg.rds"</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the crime data</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">select</span>(data, city, station, date, hour, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">a =</span> total, <span class="at">b =</span> Violent, <span class="at">c =</span> NonViolent) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(., crime, value, <span class="fu">c</span>(a, b, c))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the shares of zeros </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>zeros <span class="ot">=</span> <span class="fu">ungroup</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, crime) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(value <span class="sc">==</span> <span class="dv">0</span>), <span class="at">NoZeros =</span> <span class="fu">sum</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span><span class="sc">/</span>(<span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span> <span class="sc">+</span> NoZeros)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>NoZeros) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, crime)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Spread the data set</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">spread</span>(data, crime, value)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of summary stats</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">st</span>(<span class="fu">ungroup</span>(data) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"cdmx"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(a, b, c), </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>   <span class="at">summ =</span> <span class="fu">c</span>(<span class="st">"mean(x)"</span>, <span class="st">"var(x)"</span>, <span class="st">"min(x)"</span>, <span class="st">"max(x)"</span>, <span class="st">"notNA(x)"</span>), </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>   <span class="at">summ.names =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Variance"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"N"</span>), </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Violent"</span>, <span class="st">"Non Violent"</span>), </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>   <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">fixed.digits =</span> T, <span class="at">out =</span> <span class="st">"return"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(.,  <span class="fu">st</span>(<span class="fu">ungroup</span>(data) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"nyc"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(a, b, c), </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>   <span class="at">summ =</span> <span class="fu">c</span>(<span class="st">"mean(x)"</span>, <span class="st">"var(x)"</span>, <span class="st">"min(x)"</span>, <span class="st">"max(x)"</span>, <span class="st">"notNA(x)"</span>), </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>   <span class="at">summ.names =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Variance"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"N"</span>), </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Violent"</span>, <span class="st">"Non Violent"</span>), </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>   <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">fixed.digits =</span> T, <span class="at">out =</span> <span class="st">"return"</span>))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the year of observations</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="st">`</span><span class="at">Obs Period</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"2012-2019"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"2007-2017"</span>, <span class="dv">3</span>)))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># add the zeros</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">cbind</span>(tab, <span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span> <span class="ot">=</span> zeros<span class="sc">$</span><span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span>); tab <span class="ot">=</span> <span class="fu">cbind</span>(tab, <span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span> <span class="ot">=</span>zeros<span class="sc">$</span><span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span>)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">select</span>(tab, Variable, <span class="st">`</span><span class="at">Obs Period</span><span class="st">`</span>, Mean<span class="sc">:</span>N, <span class="st">`</span><span class="at">Zeros N</span><span class="st">`</span>, <span class="st">`</span><span class="at">Zeros %</span><span class="st">`</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Kable object </span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab) <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pack_rows</span>(<span class="st">"Mexico City"</span>, <span class="dv">1</span>, <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">pack_rows</span>(<span class="st">"Mexico City"</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table1" class="anchored">

<table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;"><caption>Table 1:  Descriptive statistics on the number of hourly crimes happening in a two-kilometer radius around pollution measuring stations in Mexico City and New York. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Variable </th>
   <th style="text-align:left;"> Obs Period </th>
   <th style="text-align:left;"> Mean </th>
   <th style="text-align:left;"> Variance </th>
   <th style="text-align:left;"> Min </th>
   <th style="text-align:left;"> Max </th>
   <th style="text-align:left;"> N </th>
   <th style="text-align:right;"> Zeros N </th>
   <th style="text-align:right;"> Zeros % </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="3"><td colspan="9" style="border-bottom: 0;"><strong>Mexico City</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Total </td>
   <td style="text-align:left;"> 2012-2019 </td>
   <td style="text-align:left;"> 0.30 </td>
   <td style="text-align:left;"> 0.53 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:left;"> 1433832 </td>
   <td style="text-align:right;"> 1125888 </td>
   <td style="text-align:right;"> 0.79 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Violent </td>
   <td style="text-align:left;"> 2012-2019 </td>
   <td style="text-align:left;"> 0.10 </td>
   <td style="text-align:left;"> 0.12 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:left;"> 1433832 </td>
   <td style="text-align:right;"> 1301749 </td>
   <td style="text-align:right;"> 0.91 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Non Violent </td>
   <td style="text-align:left;"> 2012-2019 </td>
   <td style="text-align:left;"> 0.10 </td>
   <td style="text-align:left;"> 0.15 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:left;"> 1433832 </td>
   <td style="text-align:right;"> 1316376 </td>
   <td style="text-align:right;"> 0.92 </td>
  </tr>
  <tr grouplength="3"><td colspan="9" style="border-bottom: 0;"><strong>Mexico City</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Total </td>
   <td style="text-align:left;"> 2007-2017 </td>
   <td style="text-align:left;"> 0.93 </td>
   <td style="text-align:left;"> 1.75 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 55 </td>
   <td style="text-align:left;"> 1510319 </td>
   <td style="text-align:right;"> 785423 </td>
   <td style="text-align:right;"> 0.52 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Violent </td>
   <td style="text-align:left;"> 2007-2017 </td>
   <td style="text-align:left;"> 0.16 </td>
   <td style="text-align:left;"> 0.22 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:left;"> 1510319 </td>
   <td style="text-align:right;"> 1311999 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Non Violent </td>
   <td style="text-align:left;"> 2007-2017 </td>
   <td style="text-align:left;"> 0.32 </td>
   <td style="text-align:left;"> 0.46 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 22 </td>
   <td style="text-align:left;"> 1510319 </td>
   <td style="text-align:right;"> 1154301 </td>
   <td style="text-align:right;"> 0.76 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="results-section" class="level1">
<h1>Results section</h1>
<p><a href="#tbl-Table2">Table&nbsp;2</a> contains the coefficients on the linear effect of the Now Cast AQI on crime counts in New York and Mexico City. <a href="#tbl-Table3">Table&nbsp;3</a> contains the coefficients of the quadratic model estimating the relationship between pollution and criminality. <a href="#fig-Figure6">Figure&nbsp;7</a> shows the out-of-sample prediction of the quadratic model coefficients. <a href="#fig-Figure7">Figure&nbsp;8</a> portrays the marginal effect of each additional AQI unit on criminality. <a href="#fig-Figure8">Figure&nbsp;9</a> adds the point estimates of the Nonparametric model. <a href="#tbl-Table4">Table&nbsp;4</a> contains the coefficients of the linear and quadratic models on the relationship between pollution and criminality for violent and nonviolent crimes. <a href="#tbl-Table5">Table&nbsp;5</a> contains the estimates on the effects across all crime categories.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Table 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Table 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Figure 6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Figure 7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Figure 8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Table 5</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"/02_GenData/04_results/PoissonLinear.rds"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of point estimates</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Paste the city and the specification </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">specification =</span> <span class="fu">paste</span>(city, specification, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data set by the distinct specifications </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">split</span>(tab, <span class="at">f =</span> tab<span class="sc">$</span>specification)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(y, var <span class="sc">==</span> <span class="st">"NowCast"</span>)),<span class="cf">function</span>(x) </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(<span class="st">""</span>, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r, x<span class="sc">$</span>N, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the data frame </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"names"</span>, <span class="st">"Estimate"</span>, <span class="st">""</span>, <span class="st">"N.obs"</span>, <span class="st">"R2"</span>, <span class="st">"BIC"</span>) </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">select</span>(tab, <span class="sc">-</span>V1); <span class="fu">colnames</span>(tab) <span class="ot">=</span> tab[<span class="dv">1</span>,]; tab <span class="ot">=</span> tab[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># change the column names </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="dv">2</span>), <span class="st">")"</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"MexicoCity"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Fitted-Statistics"</span>, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level."</span>, <span class="at">general_title =</span> <span class="st">"Notes:"</span>, <span class="at">footnote_as_chunk =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table2" class="anchored">

<table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 2:  Effect of pollution on criminality (linear model) </caption>
 <thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">MexicoCity</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> (1) </th>
   <th style="text-align:center;"> (2) </th>
   <th style="text-align:center;"> (3) </th>
   <th style="text-align:center;"> (1) </th>
   <th style="text-align:center;"> (2) </th>
   <th style="text-align:center;"> (3) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Estimate </td>
   <td style="text-align:center;"> 0.197 * </td>
   <td style="text-align:center;"> 0.272 ** </td>
   <td style="text-align:center;"> 0.327 ** </td>
   <td style="text-align:center;"> 0.363 *** </td>
   <td style="text-align:center;"> 0.420 *** </td>
   <td style="text-align:center;"> 0.477 *** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.111) </td>
   <td style="text-align:center;"> (0.117) </td>
   <td style="text-align:center;"> (0.131) </td>
   <td style="text-align:center;"> (0.109) </td>
   <td style="text-align:center;"> (0.102) </td>
   <td style="text-align:center;"> (0.102) </td>
  </tr>
  <tr grouplength="3"><td colspan="7" style="border-bottom: 0;"><strong>Fitted-Statistics</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> N.obs </td>
   <td style="text-align:center;"> 0.244 </td>
   <td style="text-align:center;"> 0.245 </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.223 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> R2 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1510319 </td>
   <td style="text-align:center;"> 1510319 </td>
   <td style="text-align:center;"> 1510319 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1618353 </td>
   <td style="text-align:center;"> 1618359 </td>
   <td style="text-align:center;"> 1638412 </td>
   <td style="text-align:center;"> 2844555 </td>
   <td style="text-align:center;"> 2844488 </td>
   <td style="text-align:center;"> 2862656 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Notes:</span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the Now Cast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I present estimates for three different specifications; (1) controls for station, month, hour, and weekday fixed effects, (2) accounts for seasonality by including an interaction term of year-by-month fixed effects, and (3) further interacts year-by-month with station fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model -- standard errors clustered at the station level.</td></tr></tfoot>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/PoissonQuadratic.rds"</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of point estimates</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Paste the city and the specification </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">specification =</span> <span class="fu">paste</span>(city, specification, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data set by the distinct specifications </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">split</span>(tab, <span class="at">f =</span> tab<span class="sc">$</span>specification)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(y, var <span class="sc">==</span> <span class="st">"NowCast"</span>)),<span class="cf">function</span>(x) </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r, x<span class="sc">$</span>N, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the data frame </span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"names"</span>, <span class="st">"Linear"</span>, <span class="st">" "</span>, <span class="st">"Quadratic"</span>, <span class="st">""</span>, <span class="st">"N.obs"</span>, <span class="st">"R2"</span>, <span class="st">"BIC"</span>) </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">select</span>(tab, <span class="sc">-</span>V1); <span class="fu">colnames</span>(tab) <span class="ot">=</span> tab[<span class="dv">1</span>,]; tab <span class="ot">=</span> tab[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># change the column names </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="dv">2</span>), <span class="st">")"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"MexicoCity"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Fitted-Statistics"</span>, <span class="dv">5</span>, <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table3" class="anchored">

<table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 3:  Effect of pollution on criminality (quadratic model) </caption>
 <thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">MexicoCity</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> (1) </th>
   <th style="text-align:center;"> (2) </th>
   <th style="text-align:center;"> (3) </th>
   <th style="text-align:center;"> (1) </th>
   <th style="text-align:center;"> (2) </th>
   <th style="text-align:center;"> (3) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Linear </td>
   <td style="text-align:center;"> 0.779 *** </td>
   <td style="text-align:center;"> 1.012 *** </td>
   <td style="text-align:center;"> 1.238 *** </td>
   <td style="text-align:center;"> 0.819 *** </td>
   <td style="text-align:center;"> 0.914 *** </td>
   <td style="text-align:center;"> 1.090 *** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.252) </td>
   <td style="text-align:center;"> (0.240) </td>
   <td style="text-align:center;"> (0.251) </td>
   <td style="text-align:center;"> (0.292) </td>
   <td style="text-align:center;"> (0.276) </td>
   <td style="text-align:center;"> (0.264) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Quadratic </td>
   <td style="text-align:center;"> -0.003 *** </td>
   <td style="text-align:center;"> -0.003 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.004 * </td>
   <td style="text-align:center;"> -0.004 ** </td>
   <td style="text-align:center;"> -0.005 *** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
  </tr>
  <tr grouplength="3"><td colspan="7" style="border-bottom: 0;"><strong>Fitted-Statistics</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> N.obs </td>
   <td style="text-align:center;"> 0.244 </td>
   <td style="text-align:center;"> 0.245 </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.223 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> R2 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1433832 </td>
   <td style="text-align:center;"> 1510319 </td>
   <td style="text-align:center;"> 1510319 </td>
   <td style="text-align:center;"> 1510319 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1618353 </td>
   <td style="text-align:center;"> 1618352 </td>
   <td style="text-align:center;"> 1638394 </td>
   <td style="text-align:center;"> 2844558 </td>
   <td style="text-align:center;"> 2844490 </td>
   <td style="text-align:center;"> 2862651 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.</td></tr></tfoot>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/PoissonQuadratic.rds"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var <span class="sc">==</span> <span class="st">"NowCast"</span> <span class="sc">&amp;</span> specification <span class="sc">==</span> <span class="st">"3"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the range for the out-of-sample prediction</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">city =</span> <span class="fu">c</span>(<span class="st">"cdmx"</span>, <span class="st">"nyc"</span>)) <span class="sc">%&gt;%</span> <span class="fu">split</span>(., <span class="at">f =</span> .<span class="sc">$</span>city) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(., <span class="cf">function</span>(x) <span class="fu">data.frame</span>(<span class="at">city =</span> x<span class="sc">$</span>city, <span class="at">aqi =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="dv">1</span>)))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Include the linear estimate and SE</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">lapply</span>(plot, <span class="cf">function</span>(x) </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(x, <span class="fu">select</span>(<span class="fu">filter</span>(sum, estimate <span class="sc">==</span> <span class="st">"Linear"</span>), city, <span class="at">LinearEst =</span> est, <span class="at">LinearSe =</span> se)) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(<span class="fu">filter</span>(sum, estimate <span class="sc">==</span> <span class="st">"Quadratic"</span>), city, <span class="at">QuadraticEst =</span> est, <span class="at">QuadraticSe =</span> se)))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the out-of-sample effect</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">lapply</span>(plot, <span class="cf">function</span>(x) </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(x, <span class="at">LinearValue =</span> aqi<span class="sc">*</span>LinearEst) <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">QuadraticValue =</span> aqi<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>QuadraticEst))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the effect and bliss point</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">lapply</span>(plot, <span class="cf">function</span>(x) </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(x, <span class="at">value =</span> LinearValue <span class="sc">+</span> QuadraticValue) <span class="sc">%&gt;%</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bliss =</span> <span class="fu">max</span>(<span class="fu">filter</span>(x, value <span class="sc">&gt;</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(value, <span class="dv">1</span>))<span class="sc">$</span>aqi))) <span class="sc">%&gt;%</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbindlist</span>(.)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to number of additional crimes</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> plot <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(value), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of the cities</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">mutate</span>(plot, <span class="at">city  =</span> <span class="fu">mgsub</span>(city, <span class="fu">c</span>(<span class="st">"nyc"</span>, <span class="st">"cdmx"</span>), <span class="fu">c</span>(<span class="st">"New York City"</span>, <span class="st">"Mexico City"</span>)))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> plot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">==</span> <span class="fu">max</span>(value)), </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">50</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"green"</span>)  <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> plot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">==</span> <span class="fu">max</span>(value)), </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value, <span class="at">xmin =</span> <span class="dv">51</span>, <span class="at">xmax =</span> <span class="dv">100</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>)  <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> plot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">==</span> <span class="fu">max</span>(value)), </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value, <span class="at">xmin =</span> <span class="dv">101</span>, <span class="at">xmax =</span> <span class="dv">150</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"orange"</span>)  <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> plot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">==</span> <span class="fu">max</span>(value)), </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value, <span class="at">xmin =</span> <span class="dv">151</span>, <span class="at">xmax =</span> <span class="dv">200</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"brown"</span>)  <span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> aqi, <span class="at">y =</span> value, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"white"</span>), </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"white"</span>),<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>() , <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),) <span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Crimes"</span>, <span class="at">x =</span> <span class="st">"AQI"</span>) <span class="sc">+</span> </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> <span class="fu">grids</span>() <span class="sc">+</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(plot, aqi <span class="sc">==</span> bliss), <span class="fu">aes</span>(<span class="at">x =</span> aqi, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(plot, aqi <span class="sc">==</span> bliss), <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value, <span class="at">xmin =</span> aqi, <span class="at">xmax =</span> aqi), </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(plot, aqi <span class="sc">==</span> bliss), </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(aqi, value, <span class="at">label =</span> (<span class="fu">paste</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">frac</span>(<span class="fu">paste</span>(partialdiff,<span class="st">"Crimes"</span>),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                                                           <span class="fu">paste</span>(partialdiff,<span class="st">"Pol"</span>)), <span class="st">" = 0"</span>))))), </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> T, <span class="at">hjust =</span> <span class="dv">2</span>, <span class="at">vjust =</span> <span class="fl">1.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">angle =</span> <span class="dv">90</span>)                                      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 7: Nonlinear effect of air pollution on criminality</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Notes: <em>This figure shows the value of the Now Cast AQI on the horizontal axis and the effect of multiplying linear and quadratic coefficients by this concentration level on the vertical axis. Each color block refers to the risk levels of exposure proposed by the EPA (see figure z). The vertical line indicates the point where the impact of exposure stops increasing and starts decreasing criminality. Linear and quadratic coefficients come from a PMLE panel model controlling for weather, year-by-month-by-station, hour, and weekday fixed effects – standard errors clustered at the station level.</em></p>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>nyc <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"/02_GenData/04_results/NycMarginal.rds"</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cdmx <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"/02_GenData/04_results/CdmxMarginal.rds"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add both data sets together</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">New York City</span><span class="st">`</span> <span class="ot">=</span> nyc, <span class="st">`</span><span class="at">Mexico City</span><span class="st">`</span> <span class="ot">=</span> cdmx), <span class="at">idcol =</span> <span class="st">"city"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(dydx, BtrSe), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the value in which the marginal effect crosses the horizontal axis</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">split</span>(data, <span class="at">f =</span> data<span class="sc">$</span>city) <span class="sc">%&gt;%</span> <span class="fu">lapply</span>(., <span class="cf">function</span>(x) <span class="at">x =</span> x <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(dydx) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(<span class="fu">as.numeric</span>(dydx)), <span class="at">na.rm =</span> T), <span class="fu">as.numeric</span>(NowCast), <span class="cn">NA</span>))<span class="sc">|&gt;</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(effect), <span class="at">na.r =</span> T))) <span class="sc">%&gt;%</span> <span class="fu">rbindlist</span>(.)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Review the moment in which the point estimates are no longer significant</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">positive =</span> <span class="fu">abs</span>(dydx <span class="sc">+</span> BtrSe<span class="sc">*</span><span class="fl">1.645</span>), <span class="at">negative =</span> <span class="fu">abs</span>(dydx  <span class="sc">-</span> BtrSe<span class="sc">*</span><span class="fl">1.645</span>))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="do">#### Plot the effect #####</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data) <span class="sc">+</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> NowCast, <span class="at">y =</span> dydx)) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> NowCast, <span class="at">y =</span> dydx <span class="sc">+</span> BtrSe<span class="sc">*</span><span class="fl">1.645</span>), <span class="at">col =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> NowCast, <span class="at">y =</span> dydx <span class="sc">-</span> BtrSe<span class="sc">*</span><span class="fl">1.645</span>), <span class="at">col =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> effect), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(partialdiff,<span class="st">"Crime"</span>,<span class="st">"/"</span>,partialdiff,<span class="st">"Air Pol. (90% CI)"</span>)), <span class="at">x =</span> <span class="st">"Now Cast Aqi"</span>)                                   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 8: Estimated marginal effects of air pollution on crime</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Notes: <em>This figure shows the value of the NowCast aqi on the horizontal axis and the partial derivative of criminality concerning the NowCast aqi on the vertical axis. The vertical line indicates the point where the impact of exposure stops increasing and starts decreasing criminality. Point estimates come from the PMLE panel model controlling for weather, year-by-month-by-station, hour, and weekday fixed effects. I compute the marginal effects with the R-marginal effects package. – standard errors estimated through one thousand bootstraps.</em></p>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data sets</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/PoissonNonParametric.rds"</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### Change the name of pollutants ####</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">mutate</span>(data, <span class="at">var  =</span> <span class="fu">gsub</span>(<span class="st">"NowCast"</span>, <span class="st">"AQI"</span>, var))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">mutate</span>(data, <span class="at">city  =</span> <span class="fu">mgsub</span>(city, <span class="fu">c</span>(<span class="st">"nyc"</span>, <span class="st">"cdmx"</span>), <span class="fu">c</span>(<span class="st">"New York City"</span>, <span class="st">"Mexico City"</span>)))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">#### Organize the cities as factors ####</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">mutate</span>(data, <span class="at">city =</span> <span class="fu">factor</span>(city, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Mexico City"</span>, <span class="st">"New York City"</span>)))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="do">#### Plot the point estimates for the prefered specification ####</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(data, <span class="fu">grepl</span>(<span class="st">"AQI"</span>, var), specification <span class="sc">==</span> <span class="st">"3"</span>)) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">y =</span> est), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">formula=</span>y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>, <span class="at">raw=</span><span class="cn">TRUE</span>), <span class="at">colour=</span><span class="st">"darkgrey"</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">y =</span> est)) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> est<span class="sc">-</span>se<span class="sc">*</span><span class="fl">1.645</span>, <span class="at">ymax =</span> est<span class="sc">+</span>se<span class="sc">*</span><span class="fl">1.645</span>, <span class="at">x =</span> min), <span class="at">width =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())  <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>() <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">y =</span> est<span class="sc">+</span>se<span class="sc">*</span><span class="fl">1.645</span>, <span class="at">label =</span> bin), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Exposure bin"</span>, <span class="at">y =</span> <span class="st">"Estimate"</span>) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xend=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend=</span><span class="sc">-</span><span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xend=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend=</span><span class="cn">Inf</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-Figure8-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 9: Non-parametric estimates of the effect of pollution on criminality</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Notes: <em>This figure shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the effect of one hour in the indicated bin concerning the lowest bin value. Point estimates come from a non-parametric PMLE panel model of crime as a function of six bin indicators. This model contains weather controls alongside year-by-month-by-station, hour, and weekday fixed effects. The grey line is a second-degree polynomial fit across point estimates – standard errors clustered at the station level. </em> ## Table 4</p>
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/PoissonQuadraticViolent.rds"</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of point estimates</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### Change the names of the types of crime ####</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">dependent =</span> <span class="fu">mgsub</span>(dependent, <span class="fu">c</span>(<span class="st">"NonViolent"</span>), <span class="fu">c</span>(<span class="st">"Non Violent"</span>)))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Paste the city and the specification </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">specification =</span> <span class="fu">paste</span>(city, specification, estimate, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data set by the distinct specifications </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">split</span>(tab, <span class="at">f =</span> tab<span class="sc">$</span>specification)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>violent <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(y, var <span class="sc">==</span> <span class="st">"NowCast"</span>, dependent <span class="sc">==</span> <span class="st">"Violent"</span>)),<span class="cf">function</span>(x) </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>dependent, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r2, x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the data frame </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(violent) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"names"</span>, <span class="st">""</span>, <span class="st">" "</span>, <span class="st">"N.obs"</span>, <span class="st">"R2"</span>, <span class="st">"BIC"</span>) </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>violent <span class="ot">=</span> <span class="fu">select</span>(violent, <span class="sc">-</span>V1); <span class="fu">colnames</span>(violent) <span class="ot">=</span> violent[<span class="dv">1</span>,]; violent <span class="ot">=</span> violent[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>nonviolent <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(y, var <span class="sc">==</span> <span class="st">"NowCast"</span>, dependent <span class="sc">==</span> <span class="st">"Non Violent"</span>)),<span class="cf">function</span>(x) </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>dependent, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r2, x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the data frame </span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(nonviolent) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"names"</span>, <span class="st">"  "</span>, <span class="st">"   "</span>, <span class="st">"N.obs "</span>, <span class="st">"R2 "</span>, <span class="st">"BIC "</span>) </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>nonviolent <span class="ot">=</span> <span class="fu">select</span>(nonviolent, <span class="sc">-</span>V1); <span class="fu">colnames</span>(nonviolent) <span class="ot">=</span> nonviolent[<span class="dv">1</span>,]; nonviolent <span class="ot">=</span> nonviolent[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>html <span class="ot">=</span> <span class="fu">rbind</span>(violent ,nonviolent)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co"># change the column names </span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(html) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>),<span class="dv">2</span>), <span class="st">")"</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(html, <span class="at">align =</span> <span class="st">"c"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Linear Model"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Quadratic Model"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Linear Model"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Quadratic Model"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"MexicoCity"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pack_rows</span>(<span class="st">"Violent"</span>, <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Non Violent"</span>, <span class="dv">6</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table4" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 4:  Estimates on the effects of air pollution for violent and non-violent crimes </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">MexicoCity</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Linear Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Quadratic Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Linear Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Quadratic Model</div></th>
</tr>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Linear) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Linear) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Quadratic) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Linear) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Linear) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (Quadratic) </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="5"><td colspan="7" style="border-bottom: 0;"><strong>Violent</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> 0.240 * </td>
   <td style="text-align:center;"> 1.556 *** </td>
   <td style="text-align:center;"> -0.006 *** </td>
   <td style="text-align:center;"> 0.797 *** </td>
   <td style="text-align:center;"> 1.314 ** </td>
   <td style="text-align:center;"> -0.004 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.130) </td>
   <td style="text-align:center;"> (0.304) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.168) </td>
   <td style="text-align:center;"> (0.517) </td>
   <td style="text-align:center;"> (0.004) </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> N.obs </td>
   <td style="text-align:center;"> 0.130 </td>
   <td style="text-align:center;"> 0.130 </td>
   <td style="text-align:center;"> 0.130 </td>
   <td style="text-align:center;"> 0.125 </td>
   <td style="text-align:center;"> 0.125 </td>
   <td style="text-align:center;"> 0.125 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> R2 </td>
   <td style="text-align:center;"> 1322488 </td>
   <td style="text-align:center;"> 1322488 </td>
   <td style="text-align:center;"> 1322488 </td>
   <td style="text-align:center;"> 1244562 </td>
   <td style="text-align:center;"> 1244562 </td>
   <td style="text-align:center;"> 1244562 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 870538 </td>
   <td style="text-align:center;"> 870529 </td>
   <td style="text-align:center;"> 870529 </td>
   <td style="text-align:center;"> 1085029 </td>
   <td style="text-align:center;"> 1085040 </td>
   <td style="text-align:center;"> 1085040 </td>
  </tr>
  <tr grouplength="5"><td colspan="7" style="border-bottom: 0;"><strong>Non Violent</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> 0.197 </td>
   <td style="text-align:center;"> 0.704 * </td>
   <td style="text-align:center;"> -0.002 * </td>
   <td style="text-align:center;"> 0.317 *** </td>
   <td style="text-align:center;"> 0.546 * </td>
   <td style="text-align:center;"> -0.002 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.172) </td>
   <td style="text-align:center;"> (0.407) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.097) </td>
   <td style="text-align:center;"> (0.291) </td>
   <td style="text-align:center;"> (0.002) </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> N.obs </td>
   <td style="text-align:center;"> 0.219 </td>
   <td style="text-align:center;"> 0.219 </td>
   <td style="text-align:center;"> 0.219 </td>
   <td style="text-align:center;"> 0.189 </td>
   <td style="text-align:center;"> 0.189 </td>
   <td style="text-align:center;"> 0.189 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> R2 </td>
   <td style="text-align:center;"> 1300287 </td>
   <td style="text-align:center;"> 1300287 </td>
   <td style="text-align:center;"> 1300287 </td>
   <td style="text-align:center;"> 1271109 </td>
   <td style="text-align:center;"> 1271109 </td>
   <td style="text-align:center;"> 1271109 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 777428 </td>
   <td style="text-align:center;"> 777439 </td>
   <td style="text-align:center;"> 777439 </td>
   <td style="text-align:center;"> 1597431 </td>
   <td style="text-align:center;"> 1597444 </td>
   <td style="text-align:center;"> 1597444 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/PoissonQuadraticOtherCrimes.rds"</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of point estimates</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Paste the city and the specification </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">specification =</span> <span class="fu">paste</span>(city, specification, estimate, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data set by the distinct specifications </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">split</span>(tab, <span class="at">f =</span> tab<span class="sc">$</span>specification)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(y, var <span class="sc">==</span> <span class="st">"NowCast"</span>)),<span class="cf">function</span>(x) </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>dependent, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r2, x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># change the column names </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>),<span class="dv">2</span>))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>),]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Linear Model"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Quadratic Model"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Linear Model"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Quadratic Model"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"MexicoCity"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table5" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 5:  Estimates on the effects of air pollution across different crime categories </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="2"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">MexicoCity</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="2"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Linear Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Quadratic Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Linear Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Quadratic Model</div></th>
</tr>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Quadratic </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Quadratic </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:center;"> Burglary </td>
   <td style="text-align:center;"> 0.340 </td>
   <td style="text-align:center;"> 0.214 </td>
   <td style="text-align:center;"> 0.001 </td>
   <td style="text-align:center;"> 0.169 </td>
   <td style="text-align:center;"> -0.256 </td>
   <td style="text-align:center;"> 0.004 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.304) </td>
   <td style="text-align:center;"> (0.871) </td>
   <td style="text-align:center;"> (0.004) </td>
   <td style="text-align:center;"> (0.186) </td>
   <td style="text-align:center;"> (0.571) </td>
   <td style="text-align:center;"> (0.004) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:center;"> Homicide </td>
   <td style="text-align:center;"> 0.521 </td>
   <td style="text-align:center;"> 4.562 ** </td>
   <td style="text-align:center;"> -0.019 *** </td>
   <td style="text-align:center;"> 0.084 </td>
   <td style="text-align:center;"> -9.775 </td>
   <td style="text-align:center;"> 0.089 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.850) </td>
   <td style="text-align:center;"> (1.824) </td>
   <td style="text-align:center;"> (0.007) </td>
   <td style="text-align:center;"> (12.396) </td>
   <td style="text-align:center;"> (25.925) </td>
   <td style="text-align:center;"> (0.132) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:center;"> Robbery </td>
   <td style="text-align:center;"> 0.238 * </td>
   <td style="text-align:center;"> 1.437 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> 0.395 </td>
   <td style="text-align:center;"> 1.614 * </td>
   <td style="text-align:center;"> -0.010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.137) </td>
   <td style="text-align:center;"> (0.346) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.281) </td>
   <td style="text-align:center;"> (0.887) </td>
   <td style="text-align:center;"> (0.007) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:center;"> Larceny </td>
   <td style="text-align:center;"> -0.018 </td>
   <td style="text-align:center;"> 0.256 </td>
   <td style="text-align:center;"> -0.001 </td>
   <td style="text-align:center;"> 0.293 ** </td>
   <td style="text-align:center;"> 0.529 * </td>
   <td style="text-align:center;"> -0.002 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.124) </td>
   <td style="text-align:center;"> (0.492) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.126) </td>
   <td style="text-align:center;"> (0.319) </td>
   <td style="text-align:center;"> (0.002) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:center;"> SexCrime </td>
   <td style="text-align:center;"> 0.497 </td>
   <td style="text-align:center;"> 3.099 ** </td>
   <td style="text-align:center;"> -0.012 * </td>
   <td style="text-align:center;"> 0.411 *** </td>
   <td style="text-align:center;"> 0.866 *** </td>
   <td style="text-align:center;"> -0.004 * </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.374) </td>
   <td style="text-align:center;"> (1.534) </td>
   <td style="text-align:center;"> (0.006) </td>
   <td style="text-align:center;"> (0.148) </td>
   <td style="text-align:center;"> (0.299) </td>
   <td style="text-align:center;"> (0.002) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:center;"> fraud </td>
   <td style="text-align:center;"> 0.336 </td>
   <td style="text-align:center;"> 1.580 * </td>
   <td style="text-align:center;"> -0.005 * </td>
   <td style="text-align:center;"> 0.339 </td>
   <td style="text-align:center;"> 0.586 </td>
   <td style="text-align:center;"> -0.002 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.243) </td>
   <td style="text-align:center;"> (0.917) </td>
   <td style="text-align:center;"> (0.003) </td>
   <td style="text-align:center;"> (0.318) </td>
   <td style="text-align:center;"> (1.173) </td>
   <td style="text-align:center;"> (0.009) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:center;"> other </td>
   <td style="text-align:center;"> 0.633 *** </td>
   <td style="text-align:center;"> 1.289 *** </td>
   <td style="text-align:center;"> -0.003 ** </td>
   <td style="text-align:center;"> 0.402 ** </td>
   <td style="text-align:center;"> 1.287 ** </td>
   <td style="text-align:center;"> -0.007 ** </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.128) </td>
   <td style="text-align:center;"> (0.368) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.183) </td>
   <td style="text-align:center;"> (0.521) </td>
   <td style="text-align:center;"> (0.004) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:center;"> R.Squared </td>
   <td style="text-align:center;"> 0.147 </td>
   <td style="text-align:center;"> 0.147 </td>
   <td style="text-align:center;"> 0.147 </td>
   <td style="text-align:center;"> 0.167 </td>
   <td style="text-align:center;"> 0.167 </td>
   <td style="text-align:center;"> 0.167 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the linear and squared value of the Now Cast AQI on fthe number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the Now Cast AQI. Results come from a PMLE panel model across three different specifications. Column (1) controls for station, month, hour, and weekday fixed effects, (2) includes an interaction term of year-by-month fixed effects, and (3) adds the interaction of year-by-month-by-station fixed effects. All three specifications further control linearly for wind speed and relative humidity and nonparametrically for temperature, rain, and the interaction of relative humidity and temperature -- standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="robustness-section" class="level1">
<h1>Robustness section</h1>
<p><a href="#tbl-Table6">Table&nbsp;6</a> contains the main results of the IV strategy. <a href="#tbl-Table7">Table&nbsp;7</a> looks at point estimates across different estimators, <a href="#tbl-Table8">Table&nbsp;8</a> across different specifications, and <a href="#tbl-Table9">Table&nbsp;9</a> estimates the dynamic effect with distributed lag nonlinear models.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Table 6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Table 7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Table 8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Table 9</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">list</span>(<span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"/02_GenData/04_results/99_iv/LinearWdr8.rds"</span>)),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"/02_GenData/04_results/99_iv/QuadWdr8.rds"</span>)))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">#### Bind the estimates together ####</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(tab, <span class="at">idcol =</span> <span class="st">"model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"2"</span>, var), <span class="st">"Quadratic"</span>, <span class="st">"Linear"</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">#### Take the exponent of the point estimates ####</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">#### Split the data set by the distinct specifications ####</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">mutate</span>(tab, <span class="at">city =</span> <span class="fu">paste</span>(model, city, var))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">split</span>(tab, <span class="at">f =</span> tab<span class="sc">$</span>city)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(tab, <span class="cf">function</span>(y) </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(<span class="st">""</span>, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>r2, x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(T, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># change the column names </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>,<span class="st">"Linear"</span>, <span class="st">"Linear "</span>, <span class="st">"Linear  "</span>, <span class="st">"Quadratic"</span>, <span class="st">" Linear"</span>, <span class="st">"Quadratic "</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"   "</span>,<span class="st">""</span>, <span class="st">" "</span>, <span class="st">"R.Squared"</span>, <span class="st">"N.Obs"</span>, <span class="st">"BIC"</span>); tab <span class="ot">=</span> tab[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Linear Model"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Quadratic Model"</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   <span class="fu">pack_rows</span>(<span class="st">"Fitted-Statistics"</span>, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table6" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 6:  Effects of air pollution on criminality (IV) </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Linear Model</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Quadratic Model</div></th>
</tr>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="1"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Linear   </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Quadratic </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  Linear </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Quadratic  </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> 0.327 </td>
   <td style="text-align:center;"> 1.038 *** </td>
   <td style="text-align:center;"> 2.139 *** </td>
   <td style="text-align:center;"> -0.006 ** </td>
   <td style="text-align:center;"> 1.542 ** </td>
   <td style="text-align:center;"> -0.004 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.309) </td>
   <td style="text-align:center;"> (0.186) </td>
   <td style="text-align:center;"> (0.584) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.612) </td>
   <td style="text-align:center;"> (0.006) </td>
  </tr>
  <tr grouplength="3"><td colspan="7" style="border-bottom: 0;"><strong>Fitted-Statistics</strong></td></tr>
<tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> R.Squared </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.227 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.227 </td>
   <td style="text-align:center;"> 0.227 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1322972 </td>
   <td style="text-align:center;"> 1272400 </td>
   <td style="text-align:center;"> 1322972 </td>
   <td style="text-align:center;"> 1322972 </td>
   <td style="text-align:center;"> 1272400 </td>
   <td style="text-align:center;"> 1272400 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1635929 </td>
   <td style="text-align:center;"> 2858301 </td>
   <td style="text-align:center;"> 1635938 </td>
   <td style="text-align:center;"> 1635938 </td>
   <td style="text-align:center;"> 2858315 </td>
   <td style="text-align:center;"> 2858315 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different PMLE-IV panel models with wind direction as an instrument for the NowCast Aqi. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects. Bootstrapped standard errors with two-hundred iterations clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/AlternativeEst.rds"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"nb|log"</span>, spec) <span class="sc">==</span> F, est<span class="sc">*</span><span class="dv">25</span>, (<span class="fu">exp</span>(est)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">1000</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"nb|log"</span>, spec) <span class="sc">==</span> F, se<span class="sc">*</span><span class="dv">25</span>, (<span class="fu">exp</span>(se)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">1000</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of linear coefficients</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Linear"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">gsub</span>(<span class="st">"Linear|Quadratic| "</span>, <span class="st">""</span>, spec)) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">mgsub</span>(spec, <span class="fu">c</span>(<span class="st">"ols"</span>, <span class="st">"log-ols"</span>, <span class="st">"nb"</span>), <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">split</span>(linear, <span class="at">f =</span> linear<span class="sc">$</span>col)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Quadratic"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">gsub</span>(<span class="st">"Linear|Quadratic| "</span>, <span class="st">""</span>, spec)) <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">mgsub</span>(spec, <span class="fu">c</span>(<span class="st">"ols"</span>, <span class="st">"log-ols"</span>, <span class="st">"nb"</span>), <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">split</span>(quadratic, <span class="at">f =</span> quadratic<span class="sc">$</span>col)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(quadratic, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the linear coefficients to a data frame</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(linear, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Take away bad rows</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> quadratic[<span class="sc">-</span><span class="dv">1</span>,]; linear <span class="ot">=</span> linear[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Add linear and quadratic coefficients</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(linear, quadratic))</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"OLS"</span>, <span class="st">"Log-Linear OLS "</span>, <span class="st">"Negative Binomial"</span>),<span class="dv">2</span>))</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Linear Model"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Quadratic Model"</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table7" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 7:  Effects of air pollution on criminality across different estimators </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> OLS </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Log-Linear OLS  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Negative Binomial </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> OLS </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Log-Linear OLS  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Negative Binomial </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="7" style="border-bottom: 0;"><strong>Linear Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.005 ** </td>
   <td style="text-align:center;"> 0.088 *** </td>
   <td style="text-align:center;"> 0.329 *** </td>
   <td style="text-align:center;"> 0.009 ** </td>
   <td style="text-align:center;"> 0.157 *** </td>
   <td style="text-align:center;"> 0.502 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.026) </td>
   <td style="text-align:center;"> (0.115) </td>
   <td style="text-align:center;"> (0.004) </td>
   <td style="text-align:center;"> (0.055) </td>
   <td style="text-align:center;"> (0.069) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1433822 </td>
   <td style="text-align:center;"> 1433822 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1272599 </td>
   <td style="text-align:center;"> 1272599 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 2784659 </td>
   <td style="text-align:center;"> 797576 </td>
   <td style="text-align:center;"> 1634911 </td>
   <td style="text-align:center;"> 3869900 </td>
   <td style="text-align:center;"> 1612538 </td>
   <td style="text-align:center;"> 2847884 </td>
  </tr>
  <tr grouplength="6"><td colspan="7" style="border-bottom: 0;"><strong>Quadratic Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.007 * </td>
   <td style="text-align:center;"> 0.141 * </td>
   <td style="text-align:center;"> 1.256 *** </td>
   <td style="text-align:center;"> 0.027 *** </td>
   <td style="text-align:center;"> 0.481 *** </td>
   <td style="text-align:center;"> 1.128 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.004) </td>
   <td style="text-align:center;"> (0.070) </td>
   <td style="text-align:center;"> (0.205) </td>
   <td style="text-align:center;"> (0.009) </td>
   <td style="text-align:center;"> (0.131) </td>
   <td style="text-align:center;"> (0.197) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Quadratic </td>
   <td style="text-align:center;"> -0.000 </td>
   <td style="text-align:center;"> -0.000 </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.000 ** </td>
   <td style="text-align:center;"> -0.003 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.000) </td>
   <td style="text-align:center;"> (0.000) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.000) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1433822 </td>
   <td style="text-align:center;"> 1433822 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1272599 </td>
   <td style="text-align:center;"> 1272599 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 2784671 </td>
   <td style="text-align:center;"> 797587 </td>
   <td style="text-align:center;"> 1634895 </td>
   <td style="text-align:center;"> 3869892 </td>
   <td style="text-align:center;"> 1612524 </td>
   <td style="text-align:center;"> 2847882 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across three different estimators, OLS, log-linear OLS, and Negative binomial. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/RobustSpecs.rds"</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of linear coefficients</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Linear"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">gsub</span>(<span class="st">"Linear|Quadratic| "</span>, <span class="st">""</span>, spec)) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, data)) </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">split</span>(linear, <span class="at">f =</span> linear<span class="sc">$</span>col)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Quadratic"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spec =</span> <span class="fu">gsub</span>(<span class="st">"Linear|Quadratic| "</span>, <span class="st">""</span>, spec)) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, data)) </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">split</span>(quadratic, <span class="at">f =</span> quadratic<span class="sc">$</span>col)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(quadratic, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the linear coefficients to a data frame</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(linear, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) , <span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Take away bad rows</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> quadratic[<span class="sc">-</span><span class="dv">1</span>,]; linear <span class="ot">=</span> linear[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add linear and quadratic coefficients</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(linear, quadratic))</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"(1)"</span>, <span class="st">"(2) "</span>, <span class="st">"(3)"</span>, <span class="st">"(4)"</span>),<span class="dv">2</span>))</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Linear Model"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Quadratic Model"</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table8" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 8:  Robustness exercises on the effects of air pollution on criminality </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (1) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (2)  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (3) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (4) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (1) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (2)  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (3) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (4) </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="9" style="border-bottom: 0;"><strong>Linear Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.262 *** </td>
   <td style="text-align:center;"> 0.228 ** </td>
   <td style="text-align:center;"> 0.228 ** </td>
   <td style="text-align:center;"> 0.084 </td>
   <td style="text-align:center;"> 0.459 *** </td>
   <td style="text-align:center;"> 0.598 *** </td>
   <td style="text-align:center;"> 0.584 *** </td>
   <td style="text-align:center;"> 0.723 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.100) </td>
   <td style="text-align:center;"> (0.109) </td>
   <td style="text-align:center;"> (0.109) </td>
   <td style="text-align:center;"> (0.214) </td>
   <td style="text-align:center;"> (0.072) </td>
   <td style="text-align:center;"> (0.086) </td>
   <td style="text-align:center;"> (0.087) </td>
   <td style="text-align:center;"> (0.161) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1269775 </td>
   <td style="text-align:center;"> 1184536 </td>
   <td style="text-align:center;"> 1184536 </td>
   <td style="text-align:center;"> 1082248 </td>
   <td style="text-align:center;"> 1220013 </td>
   <td style="text-align:center;"> 1256884 </td>
   <td style="text-align:center;"> 1256884 </td>
   <td style="text-align:center;"> 1213987 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1516118 </td>
   <td style="text-align:center;"> 717986 </td>
   <td style="text-align:center;"> 717986 </td>
   <td style="text-align:center;"> 254487 </td>
   <td style="text-align:center;"> 2728597 </td>
   <td style="text-align:center;"> 2098240 </td>
   <td style="text-align:center;"> 1879357 </td>
   <td style="text-align:center;"> 994447 </td>
  </tr>
  <tr grouplength="6"><td colspan="9" style="border-bottom: 0;"><strong>Quadratic Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 1.248 *** </td>
   <td style="text-align:center;"> 1.595 *** </td>
   <td style="text-align:center;"> 1.595 *** </td>
   <td style="text-align:center;"> 1.356 ** </td>
   <td style="text-align:center;"> 1.079 *** </td>
   <td style="text-align:center;"> 1.335 *** </td>
   <td style="text-align:center;"> 1.423 *** </td>
   <td style="text-align:center;"> 1.331 ** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.226) </td>
   <td style="text-align:center;"> (0.290) </td>
   <td style="text-align:center;"> (0.290) </td>
   <td style="text-align:center;"> (0.647) </td>
   <td style="text-align:center;"> (0.196) </td>
   <td style="text-align:center;"> (0.327) </td>
   <td style="text-align:center;"> (0.323) </td>
   <td style="text-align:center;"> (0.602) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Quadratic </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.006 *** </td>
   <td style="text-align:center;"> -0.006 *** </td>
   <td style="text-align:center;"> -0.006 ** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.006 *** </td>
   <td style="text-align:center;"> -0.007 *** </td>
   <td style="text-align:center;"> -0.005 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.003) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.004) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1269775 </td>
   <td style="text-align:center;"> 1184536 </td>
   <td style="text-align:center;"> 1184536 </td>
   <td style="text-align:center;"> 1082248 </td>
   <td style="text-align:center;"> 1220013 </td>
   <td style="text-align:center;"> 1256884 </td>
   <td style="text-align:center;"> 1256884 </td>
   <td style="text-align:center;"> 1213987 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1516098 </td>
   <td style="text-align:center;"> 717980 </td>
   <td style="text-align:center;"> 717980 </td>
   <td style="text-align:center;"> 254497 </td>
   <td style="text-align:center;"> 2728593 </td>
   <td style="text-align:center;"> 2098239 </td>
   <td style="text-align:center;"> 1879356 </td>
   <td style="text-align:center;"> 994459 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{***}p&lt;0.01$, $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast Aqi on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Results come from two different panel models across four different robustness exercises. The linear model only controls for the effect of the NowCast Aqi, and the quadratic model further includes its squared value as an additional covariate. Column (1) contains estimates of a regression model where I assign all crimes within a 2km radius to each measuring station. The only difference with the standard design is that crimes can now be assigned to more than one station as long as they occur within the 2 km catchment radius. In (2), I exclude all observations happening at midday because of the irregular jump in the number of crimes occurring at this hour. Finally, columns (3) and (4) reduce the catchment radius of measuring stations to 1,000 and 500 meters. Interpret coefficients as the percentage increase in criminality due to a ten units increase in the NowCast Aqi. The econometric design additionally accounts for weather controls and year-by-month-by-station, hour, and weekday fixed effects -- standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">Linear Model</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/LinearDynamic.rds"</span>)),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">Quadratic Model</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/QuadraticDynamic.rds"</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">#### Bind the estimates together ####</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(tab, <span class="at">idcol =</span> <span class="st">"model"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of linear coefficients</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Linear"</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(sample, spec)) </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">split</span>(linear, <span class="at">f =</span> linear<span class="sc">$</span>col)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame of the quadratic coefficients</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Quadratic"</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(sample, spec)) </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">split</span>(quadratic, <span class="at">f =</span> quadratic<span class="sc">$</span>col)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(quadratic, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>type, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>nobs, x<span class="sc">$</span>r2),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the linear coefficients to a data frame</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(linear, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>type, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"R.Squared"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>nobs, x<span class="sc">$</span>r2),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(T, <span class="fu">nrow</span>(x))))),</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Take away bad rows</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> quadratic[<span class="sc">-</span><span class="dv">1</span>,]; linear <span class="ot">=</span> linear[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add linear and quadratic coefficients</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(linear, quadratic))</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Lag 1"</span>, <span class="st">"Lag 4"</span>, <span class="st">"Lag 8"</span>, <span class="st">"Lag 16"</span>),<span class="dv">2</span>))</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Linear Model"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Quadratic Model"</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from distributed lag non-linear model estimates with Poisson pseudo-maximum likelihood estimators. We present results for models across four lag structures (1, 4, 8, and 16 hours before the crime). All estimates contain weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level.."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-Table9" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 9:  Effects of air pollution on criminality for different lag models </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 1 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 4 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 8 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 16 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 1 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 4 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 8 </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Lag 16 </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="9" style="border-bottom: 0;"><strong>Linear Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.188 </td>
   <td style="text-align:center;"> 0.193 * </td>
   <td style="text-align:center;"> 0.114 </td>
   <td style="text-align:center;"> 0.099 </td>
   <td style="text-align:center;"> 0.558 *** </td>
   <td style="text-align:center;"> 0.612 *** </td>
   <td style="text-align:center;"> 0.728 *** </td>
   <td style="text-align:center;"> 0.658 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.143) </td>
   <td style="text-align:center;"> (0.110) </td>
   <td style="text-align:center;"> (0.083) </td>
   <td style="text-align:center;"> (0.083) </td>
   <td style="text-align:center;"> (0.095) </td>
   <td style="text-align:center;"> (0.100) </td>
   <td style="text-align:center;"> (0.113) </td>
   <td style="text-align:center;"> (0.126) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324973 </td>
   <td style="text-align:center;"> 1324944 </td>
   <td style="text-align:center;"> 1324910 </td>
   <td style="text-align:center;"> 1324885 </td>
   <td style="text-align:center;"> 1510106 </td>
   <td style="text-align:center;"> 1510025 </td>
   <td style="text-align:center;"> 1509917 </td>
   <td style="text-align:center;"> 1509809 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> R.Squared </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.220 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
   <td style="text-align:center;"> 0.224 </td>
  </tr>
  <tr grouplength="6"><td colspan="9" style="border-bottom: 0;"><strong>Quadratic Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 1.173 *** </td>
   <td style="text-align:center;"> 0.930 *** </td>
   <td style="text-align:center;"> 0.908 *** </td>
   <td style="text-align:center;"> 0.927 *** </td>
   <td style="text-align:center;"> 1.352 *** </td>
   <td style="text-align:center;"> 1.542 *** </td>
   <td style="text-align:center;"> 1.546 *** </td>
   <td style="text-align:center;"> 1.501 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.307) </td>
   <td style="text-align:center;"> (0.291) </td>
   <td style="text-align:center;"> (0.304) </td>
   <td style="text-align:center;"> (0.315) </td>
   <td style="text-align:center;"> (0.264) </td>
   <td style="text-align:center;"> (0.273) </td>
   <td style="text-align:center;"> (0.294) </td>
   <td style="text-align:center;"> (0.344) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Quadratic </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.003 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.007 *** </td>
   <td style="text-align:center;"> -0.008 *** </td>
   <td style="text-align:center;"> -0.007 *** </td>
   <td style="text-align:center;"> -0.007 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.003) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324973 </td>
   <td style="text-align:center;"> 1324944 </td>
   <td style="text-align:center;"> 1324910 </td>
   <td style="text-align:center;"> 1324885 </td>
   <td style="text-align:center;"> 1510106 </td>
   <td style="text-align:center;"> 1510025 </td>
   <td style="text-align:center;"> 1509917 </td>
   <td style="text-align:center;"> 1509809 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> R.Squared </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from distributed lag non-linear model estimates with Poisson pseudo-maximum likelihood estimators. We present results for models across four lag structures (1, 4, 8, and 16 hours before the crime). All estimates contain weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret point estimates as the percentage change in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level..</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<ul>
<li>Figure A1: Bar plot on the number of stations per year in Mexico City and New York.</li>
<li>Figure A2: Color coded health risks for the EPA air quality index.</li>
<li>Table A1: Effects of air pollution on criminality across different specifications of weather covariates.</li>
<li>Table A2: Effects of air pollution on criminality across different clustering of standard errors.</li>
<li>Figure A3: Box plots of raw and IV-fitted values of the NowCast AQI</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Figure A1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Figure A2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Table A1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Table A2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">Figure A3</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the path </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/03_RegData/DataReg.rds"</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the data for the plot</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city, year) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">stations =</span> <span class="fu">length</span>(<span class="fu">unique</span>(station))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"nyc"</span>, city), <span class="st">"New York"</span>, <span class="st">"Mexico City"</span>)) </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the number of stations per year for both cities</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot) <span class="sc">+</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> stations), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(), <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.7</span>))  <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of Stations"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-FigureA1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-FigureA1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 10: Number of stations per year</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div id="fig-figureA2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/AQIEPA.PNG" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 11: Color coded health risks for the EPA air quality index</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/AlternativeWeatherEst.rds"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of linear coefficients</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Linear"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">split</span>(linear, <span class="at">f =</span> linear<span class="sc">$</span>col)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame of the quadratic coefficients</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Quadratic"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">split</span>(quadratic, <span class="at">f =</span> quadratic<span class="sc">$</span>col)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(quadratic, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the linear coefficients to a data frame</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(linear, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(T, <span class="fu">nrow</span>(x))))),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Take away bad rows</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> quadratic[<span class="sc">-</span><span class="dv">1</span>,]; linear <span class="ot">=</span> linear[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add linear and quadratic coefficients</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(linear, quadratic))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"(1)"</span>, <span class="st">"(2)"</span>, <span class="st">"(3)"</span>),<span class="dv">2</span>))</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Linear Model"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Quadratic Model"</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I report coefficients for three different specifications of weather covariates. (1) has not weather controls, (2) includes temperature, relative humidity, precipitation, and wind speed linearly, and (3) further adds the square value of temperature and precipitation. Point estimates come PMLE panel models with year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients as percentage changes in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"600px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-TableA1" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:600px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 10:  Effects of air pollution on criminality across different specifications of weather covariates </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (1) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (2) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (3) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (1) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (2) </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> (3) </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="7" style="border-bottom: 0;"><strong>Linear Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.324 *** </td>
   <td style="text-align:center;"> 0.314 *** </td>
   <td style="text-align:center;"> 0.292 ** </td>
   <td style="text-align:center;"> 0.658 *** </td>
   <td style="text-align:center;"> 0.638 *** </td>
   <td style="text-align:center;"> -0.003 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.125) </td>
   <td style="text-align:center;"> (0.118) </td>
   <td style="text-align:center;"> (0.118) </td>
   <td style="text-align:center;"> (0.082) </td>
   <td style="text-align:center;"> (0.057) </td>
   <td style="text-align:center;"> (0.081) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1510133 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1638094.241 </td>
   <td style="text-align:center;"> 1638126.991 </td>
   <td style="text-align:center;"> 1638080.024 </td>
   <td style="text-align:center;"> 2862036.131 </td>
   <td style="text-align:center;"> 3395871.284 </td>
   <td style="text-align:center;"> 2863164.939 </td>
  </tr>
  <tr grouplength="6"><td colspan="7" style="border-bottom: 0;"><strong>Quadratic Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 1.273 *** </td>
   <td style="text-align:center;"> 1.358 *** </td>
   <td style="text-align:center;"> 1.334 *** </td>
   <td style="text-align:center;"> 1.531 *** </td>
   <td style="text-align:center;"> 0.535 ** </td>
   <td style="text-align:center;"> 1.125 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.215) </td>
   <td style="text-align:center;"> (0.194) </td>
   <td style="text-align:center;"> (0.192) </td>
   <td style="text-align:center;"> (0.180) </td>
   <td style="text-align:center;"> (0.211) </td>
   <td style="text-align:center;"> (0.202) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Quadratic </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.008 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1510133 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1638102 </td>
   <td style="text-align:center;"> 1638048 </td>
   <td style="text-align:center;"> 1638067 </td>
   <td style="text-align:center;"> 3395836 </td>
   <td style="text-align:center;"> 2863164 </td>
   <td style="text-align:center;"> 2862039 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. I report coefficients for three different specifications of weather covariates. (1) has not weather controls, (2) includes temperature, relative humidity, precipitation, and wind speed linearly, and (3) further adds the square value of temperature and precipitation. Point estimates come PMLE panel models with year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients as percentage changes in the number of crimes due to a ten units increase in the NowCast AQI--standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell tbl-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/04_results/AlternativeRobustSe.rds"</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the exponent of the point estimates </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> tab <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(est, se), <span class="cf">function</span>(x) <span class="at">x =</span> (<span class="fu">exp</span>(x) <span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame of linear coefficients</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Linear"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">split</span>(linear, <span class="at">f =</span> linear<span class="sc">$</span>col)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame of the quadratic coefficients</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Quadratic"</span>, spec)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">paste</span>(city, spec)) </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">split</span>(quadratic, <span class="at">f =</span> quadratic<span class="sc">$</span>col)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data-frame for the html table</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(quadratic, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(F, <span class="fu">nrow</span>(x))))),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the linear coefficients to a data frame</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">=</span> <span class="fu">matrixreg</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(linear, <span class="cf">function</span>(y) <span class="at">y =</span> y),<span class="cf">function</span>(x) </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createTexreg</span>(x<span class="sc">$</span>estimate, x<span class="sc">$</span>est,x<span class="sc">$</span>se, x<span class="sc">$</span>p,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof.names =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">"N.Obs"</span>, <span class="fu">nrow</span>(x)) ,<span class="fu">rep</span>(<span class="st">"BIC"</span>, <span class="fu">nrow</span>(x))),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gof =</span> <span class="fu">c</span>(x<span class="sc">$</span>n, x<span class="sc">$</span>BIC),<span class="at">gof.decimal =</span> <span class="fu">c</span>(<span class="fu">rep</span>(F, <span class="fu">nrow</span>(x)), <span class="fu">rep</span>(T, <span class="fu">nrow</span>(x))))),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> T, <span class="at">symbol =</span> <span class="st">"+"</span>, <span class="at">digits =</span> <span class="dv">3</span>,<span class="at">stars =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(.)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Take away bad rows</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>quadratic <span class="ot">=</span> quadratic[<span class="sc">-</span><span class="dv">1</span>,]; linear <span class="ot">=</span> linear[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add linear and quadratic coefficients</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(linear, quadratic))</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Station-by-month"</span>, <span class="st">"Station-by-Week"</span>, <span class="st">"Station-by-Date"</span>),<span class="dv">2</span>))</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HTML table of the first figure</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(tab, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mexico City"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"New York"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_option =</span> <span class="fu">c</span>(<span class="st">"hover"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Linear Model"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Quadratic Model"</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"$^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from OLS and log-linear OLS panel models with weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients in the OLS model as the marginal effect of increasing each particle by one hundred units and in the log-linear design as percentage changes in the number of crimes due to a ten units increase in the NowcAST aqi--standard errors clustered at the station level."</span>, <span class="at">footnote_as_chunk =</span> T) <span class="sc">%&gt;%</span>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"600px"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-TableA2" class="anchored">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:600px; "><table class=" lightable-classic table table table-hover" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; font-size: 14px; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;"><caption>Table 11:  Effects of air pollution on criminality across different clustering of standard errors </caption>
 <thead>
<tr>
<th style="empty-cells: hide;position: sticky; top:0; background-color: #FFFFFF;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Mexico City</div></th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">New York</div></th>
</tr>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">  </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-month </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-Week </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-Date </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-month </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-Week </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> Station-by-Date </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="7" style="border-bottom: 0;"><strong>Linear Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 0.327 ** </td>
   <td style="text-align:center;"> 0.327 ** </td>
   <td style="text-align:center;"> 0.327 ** </td>
   <td style="text-align:center;"> 0.477 *** </td>
   <td style="text-align:center;"> 0.477 *** </td>
   <td style="text-align:center;"> 0.477 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.131) </td>
   <td style="text-align:center;"> (0.133) </td>
   <td style="text-align:center;"> (0.135) </td>
   <td style="text-align:center;"> (0.102) </td>
   <td style="text-align:center;"> (0.125) </td>
   <td style="text-align:center;"> (0.105) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1638412.393 </td>
   <td style="text-align:center;"> 1638412.393 </td>
   <td style="text-align:center;"> 1638412.393 </td>
   <td style="text-align:center;"> 2862655.689 </td>
   <td style="text-align:center;"> 2862655.689 </td>
   <td style="text-align:center;"> 2862655.689 </td>
  </tr>
  <tr grouplength="6"><td colspan="7" style="border-bottom: 0;"><strong>Quadratic Model</strong></td></tr>
<tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Linear </td>
   <td style="text-align:center;"> 1.238 *** </td>
   <td style="text-align:center;"> 1.238 *** </td>
   <td style="text-align:center;"> 1.238 *** </td>
   <td style="text-align:center;"> 1.090 *** </td>
   <td style="text-align:center;"> 1.090 *** </td>
   <td style="text-align:center;"> 1.090 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.251) </td>
   <td style="text-align:center;"> (0.260) </td>
   <td style="text-align:center;"> (0.258) </td>
   <td style="text-align:center;"> (0.264) </td>
   <td style="text-align:center;"> (0.268) </td>
   <td style="text-align:center;"> (0.264) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> Quadratic </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.004 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
   <td style="text-align:center;"> -0.005 *** </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1">  </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.001) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
   <td style="text-align:center;"> (0.002) </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> N.Obs </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1324983 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1272440 </td>
   <td style="text-align:center;"> 1272440 </td>
  </tr>
  <tr>
   <td style="text-align:center;padding-left: 2em;" indentlevel="1"> BIC </td>
   <td style="text-align:center;"> 1638394 </td>
   <td style="text-align:center;"> 1638394 </td>
   <td style="text-align:center;"> 1638394 </td>
   <td style="text-align:center;"> 2862651 </td>
   <td style="text-align:center;"> 2862651 </td>
   <td style="text-align:center;"> 2862651 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> $^{**}p&lt;0.05$, $^*p&lt;0.1$. This table shows the effect of the NowCast AQI on the number of crimes occurring in a two-kilometer radius around pollution measuring stations in Mexico City and New York. Point estimates come from OLS and log-linear OLS panel models with weather controls and year-by-month-by-station, hour, and weekday fixed effects. Interpret coefficients in the OLS model as the marginal effect of increasing each particle by one hundred units and in the log-linear design as percentage changes in the number of crimes due to a ten units increase in the NowcAST aqi--standard errors clustered at the station level.</td></tr></tfoot>
</table></div>

</div>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell fig-cap-location-top">
<details>
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the path </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"NonLinearCrime/"</span>,<span class="st">""</span>, <span class="fu">getwd</span>()), <span class="st">"/ReplicationFolder/"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(file, <span class="st">"02_GenData/03_RegData/DataReg.rds"</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">split</span>(data, <span class="at">f =</span> data<span class="sc">$</span>city)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### Only keep the variables relevant for the regression design ####</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">lapply</span>(data, <span class="cf">function</span>(x) </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, date, total, NowCast, wsp, rh, rh_ntile, wdr8,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>         station, year, month, hour, weekday, temp_ntile, rain_ntile))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the first stage estimates of the NowCast as a function of wind direction</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>est <span class="ot">=</span> <span class="fu">lapply</span>(data, <span class="cf">function</span>(x) </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fepois</span>(NowCast <span class="sc">~</span> wsp <span class="sc">+</span> rh <span class="sc">|</span> station<span class="sc">^</span>year<span class="sc">^</span>month <span class="sc">+</span> hour<span class="sc">^</span>station <span class="sc">+</span> weekday <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>           temp_ntile <span class="sc">+</span> rain_ntile <span class="sc">+</span> rh_ntile<span class="sc">^</span>temp_ntile <span class="sc">+</span> wdr8<span class="sc">^</span>station, <span class="at">data =</span> x))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fitted values of the NowCast index</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>predict <span class="ot">=</span> <span class="fu">lapply</span>(est, <span class="cf">function</span>(x) <span class="fu">data.frame</span>(<span class="at">NowCastIv =</span> <span class="fu">fitted.values</span>(x, <span class="at">na.rm =</span> F)))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the fitted AQI to the original data</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>cdmx <span class="ot">=</span> <span class="fu">cbind</span>(data<span class="sc">$</span>cdmx, predict<span class="sc">$</span>cdmx)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nyc <span class="ot">=</span> <span class="fu">cbind</span>(data<span class="sc">$</span>nyc, predict<span class="sc">$</span>nyc); <span class="fu">rm</span>(predict)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the box-plotm</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">select</span>(<span class="fu">rbindlist</span>(data, <span class="at">idcol =</span> <span class="st">"city"</span>), station, date, hour, city, NowCast, NowCastIv)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to long format</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">gather</span>(plot, variable, value, <span class="sc">-</span><span class="fu">c</span>(station<span class="sc">:</span>city))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Restrict to the first and 99th percentile of the distribution</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">ungroup</span>(plot) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(city, variable) <span class="sc">%&gt;%</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">&lt;</span> <span class="fu">quantile</span>(value, <span class="fl">0.99</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>         value <span class="sc">&gt;</span> <span class="fu">quantile</span>(value, <span class="fl">0.01</span>, <span class="at">na.rm =</span> T))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of the cities</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> <span class="fu">mutate</span>(plot, <span class="at">city =</span> <span class="fu">ifelse</span>(city <span class="sc">==</span> <span class="st">"nyc"</span>, <span class="st">"New York City"</span>, <span class="st">"Mexico City"</span>), </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable =</span> <span class="fu">ifelse</span>(variable <span class="sc">==</span> <span class="st">"NowCast"</span>, <span class="st">"Raw AQI"</span>, <span class="st">"Instrumented AQI"</span>))</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the ggplot</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot)  <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable), <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(), </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())  <span class="sc">+</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">color =</span> <span class="st">"gray80"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"antiquewhite"</span>, <span class="st">"darkorange"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-FigureA3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02_exhibits_files/figure-html/fig-FigureA3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 12: Box plots of raw and IV-fitted values of the NowCast AQI</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Notes: <em>Box plots of raw and IV-fitted air pollution values. The box lines represent the median, 10th, and 90th percentile, while the Whiskers upper and lower limits are the 1st and 99th percentiles of the distribution.</em></p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>